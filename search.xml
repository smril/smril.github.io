<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>SNCtest</title>
    <url>/2020/11/17/SNCtest/</url>
    <content><![CDATA[<p>##SNCtest</p>
<p>hello world!</p>
]]></content>
  </entry>
  <entry>
    <title>hexo d后撤销，再次上传时失败解决办法</title>
    <url>/2020/06/12/hexo-d%E5%90%8E%E6%92%A4%E9%94%80%EF%BC%8C%E5%86%8D%E6%AC%A1%E4%B8%8A%E4%BC%A0%E6%97%B6%E5%A4%B1%E8%B4%A5%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/</url>
    <content><![CDATA[<p>在博客里添加下载功能，只需要在source中添加一个download文件夹，将文件放在里面，然后在博客中写：<br>[显示信息](\download\文件名) 即可</p>
<a id="more"></a>
<p>但是如果上传中途失败或者撤销了，再次上传的时候有可能会报错，上网找了好久都没有找到解决办法，最后发现此时的hexo博客文件夹的大小与上传前备份的大小有很大的差异，刚好就是我没有上传成功的文件的大小，在finder中比较现在和备份的文件夹，发下大小都一致，说明是有一个隐藏的文件，我们只需要替换这个文件就好了。</p>
<p>进入终端root模式，来到hexo博客目录下，ls展示,输入 du -sh ./文件名查看文件大小，最终得知罪魁祸首是.deploy_git,将这个文件用备份的替换掉即可</p>
<p><img src="/2020/06/12/hexo-d%E5%90%8E%E6%92%A4%E9%94%80%EF%BC%8C%E5%86%8D%E6%AC%A1%E4%B8%8A%E4%BC%A0%E6%97%B6%E5%A4%B1%E8%B4%A5%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/ls.png" alt="目录展示"></p>
<p>mv 备份文件 博客目录</p>
<p>完</p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
  </entry>
  <entry>
    <title>java学习笔记--五子棋(1)</title>
    <url>/2020/08/10/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%94%E5%AD%90%E6%A3%8B-1/</url>
    <content><![CDATA[<h3 id="Java学习笔记–五子棋-1"><a href="#Java学习笔记–五子棋-1" class="headerlink" title="Java学习笔记–五子棋(1)"></a>Java学习笔记–五子棋(1)</h3><p>实现棋盘的绘制，五子棋的刷新</p>
<a id="more"></a>

<h3 id="知识准备"><a href="#知识准备" class="headerlink" title="知识准备"></a>知识准备</h3><p>实现绘制棋盘和棋子，要用到两个类，一个是JFrame，是用来生成窗体的，下面是常用方法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> JFrame()  <span class="comment">//创建一个无标题的窗口。</span></span><br><span class="line"></span><br><span class="line">JFrame(String s)  <span class="comment">//创建标题为s的窗口。</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">voidsetBounds</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> width,<span class="keyword">int</span> height)</span>  <span class="comment">//设置窗口的初始位置是(a,b),即距屏幕左面a个像素，距屏幕上方b个像素，窗口的宽是width,高是height。</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSize</span><span class="params">(<span class="keyword">int</span> width,<span class="keyword">int</span> height)</span>  <span class="comment">//设置窗口的大小。</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLocation</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span>  <span class="comment">//设置窗口的位置，默认位置是(0,0)。</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVisible</span><span class="params">(<span class="keyword">boolean</span> b)</span>  <span class="comment">//设置窗口是否可见，窗口默认是不可见的。</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">voidsetResizable</span><span class="params">(<span class="keyword">boolean</span> b)</span>  <span class="comment">//设置窗口是否可调整大小，默认可调整大小。</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">voiddispose</span><span class="params">()</span>  <span class="comment">//撤销当前窗口，并释放当前窗口所使用的资源。</span></span></span><br></pre></td></tr></table></figure>

<p>接下来是鼠标监听器方法MouseListener，听名字就知道用途了，下面是常用方法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span>   <span class="title">MouseClicked</span> <span class="params">(MouseEvent e)</span>    <span class="comment">//鼠标点击（单或双）</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span>   <span class="title">MousePressed</span> <span class="params">(MouseEvent e)</span>    <span class="comment">//鼠标按下</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span>   <span class="title">MouseReleased</span><span class="params">(MouseEvent e)</span>    <span class="comment">//鼠标松开</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span>   <span class="title">MouseEntered</span> <span class="params">(MouseEvent e)</span>    <span class="comment">//鼠标进入（某组件区域）</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span>   <span class="title">MouseExited</span>  <span class="params">(MouseEvent e)</span>    <span class="comment">//鼠标离开（某组件区域）</span></span></span><br></pre></td></tr></table></figure>
<h3 id="绘制窗体"><a href="#绘制窗体" class="headerlink" title="绘制窗体"></a>绘制窗体</h3><p>首先我们写一个继承自JFrame类的子类， 注意如果编译器没有自动导包的话，要加：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br></pre></td></tr></table></figure>
<p>然后写建立窗体的方法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initfunc</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setTitle(<span class="string">"五子棋-ver0.1"</span>);</span><br><span class="line">        <span class="keyword">this</span>.setSize(<span class="number">1000</span>, <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">this</span>.setResizable(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">this</span>.setLocationRelativeTo(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">this</span>.setDefaultCloseOperation(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">this</span>.getContentPane().setBackground(<span class="keyword">new</span> Color(<span class="number">217</span>, <span class="number">207</span>, <span class="number">175</span>));</span><br><span class="line">        <span class="keyword">this</span>.setVisible(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>这样我们就有了一个窗体，但是如果只设置窗体，窗体里面是没有任何内容的，我们还要重写paint函数，paint是JFrame类里的一个方法，这个方法是不用调用的，只需要在里面写上super.paint(g)即可。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">paint</span><span class="params">(Graphics g)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.paint(g);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/10/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%94%E5%AD%90%E6%A3%8B-1/%E4%BA%94%E5%AD%90%E6%A3%8B.png" alt="五子棋"></p>
<p>接下来我们划线，划线方法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">chessfunc</span><span class="params">(Graphics g)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">19</span>; i++) &#123;</span><br><span class="line">            g.drawLine(<span class="number">50</span>, <span class="number">50</span> + i * <span class="number">50</span>, <span class="number">50</span> + <span class="number">18</span> * <span class="number">50</span>, <span class="number">50</span> + i * <span class="number">50</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">19</span>; i++) &#123;</span><br><span class="line">            g.drawLine(<span class="number">50</span> + i * <span class="number">50</span>, <span class="number">50</span>, <span class="number">50</span> + i * <span class="number">50</span>, <span class="number">50</span> + <span class="number">18</span> * <span class="number">50</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>这个50的间距是自定的，由于参考教程就是50，这里也是50比较方便。向paint中添加调用本方法的代码</p>
<p><img src="/2020/08/10/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%94%E5%AD%90%E6%A3%8B-1/%E4%BA%94%E5%AD%90%E6%A3%8B%E5%88%92%E7%BA%BF.png" alt="五子棋划线"></p>
<p>这样棋盘就绘制好了。</p>
<h3 id="绘制棋子"><a href="#绘制棋子" class="headerlink" title="绘制棋子"></a>绘制棋子</h3><p>棋子的绘制需要用到repaint方法，这个方法是写在鼠标监听类里的，首先这个子类要这么写：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyMouseListener</span> <span class="keyword">implements</span> <span class="title">MouseListener</span></span></span><br></pre></td></tr></table></figure>
<p>然后编译器会把上文一堆方法自动补全，我们要用到的办法就只有mousePressed和mouseReleased，<br>一个用来监听绘制棋子，一个用来防止改变已有棋子的颜色，首先是mousePressed方法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mousePressed</span><span class="params">(MouseEvent e)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = e.getX();</span><br><span class="line">    <span class="keyword">int</span> x = e.getY();</span><br><span class="line">    <span class="keyword">int</span> cow = y / <span class="number">50</span>;</span><br><span class="line">    <span class="keyword">int</span> col = x / <span class="number">50</span>;</span><br><span class="line">    <span class="keyword">if</span>(x - <span class="number">50</span> * col &lt; <span class="number">50</span> / <span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(y - <span class="number">50</span> * cow &lt; <span class="number">50</span> / <span class="number">2</span>)&#123;</span><br><span class="line">            cow--;</span><br><span class="line">        &#125;</span><br><span class="line">        col--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(y - <span class="number">50</span> * cow &lt; <span class="number">50</span> / <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cow--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (main.chess[cow][col].color == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        main.chess[cow][col].color = chesscol;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        chesscol = <span class="number">1</span> - chesscol;</span><br><span class="line">    &#125;</span><br><span class="line">    main.repaint();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里要讲的是教程里很巧妙的办法，我们再点击棋盘落子的时候，几乎不可能精准的点到两条线交汇的地点，所以我们要把这个点附近的所有点都近似到这个点上，具体的办法就是把一个正方形分成4份，每一份对应一个角，这样就解决了点的不精准的问题，具体的代码如上。</p>
<p>上面出现的数组是一个存储棋子的数组，具体如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">chess</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">int</span> y;</span><br><span class="line">    <span class="keyword">int</span> color; <span class="comment">// '0'代表黑色，'1'代表白色，'2'代表还没有落子</span></span><br><span class="line">    chess(<span class="keyword">int</span> row, <span class="keyword">int</span> col)</span><br><span class="line">    &#123;</span><br><span class="line">        x = row * <span class="number">50</span> + <span class="number">50</span>;</span><br><span class="line">        y = col * <span class="number">50</span> + <span class="number">50</span>;</span><br><span class="line">        color = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>chesscol意思是棋子的颜色，0为白色，1为黑色。可以看到上面的代码，如果我们点到了有棋子的地方，他就会执行chesscol = 1 - chesscol，这样等于交换了棋子的颜色，所以我们为了不改变颜色，我们在mouseReleased里再次改变颜色即可。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseReleased</span><span class="params">(MouseEvent e)</span> </span>&#123;</span><br><span class="line">        chesscol = <span class="number">1</span> - chesscol;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>在代码里，有main.chess[][]; main.repaint();这里的main通过</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> initUI main;</span><br><span class="line"></span><br><span class="line">    MyMouseListener(initUI main)&#123;</span><br><span class="line">        <span class="keyword">this</span>.main = main;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>传入</p>
<p>接下来完UI类，首先传入鼠标监听器，然后建立棋盘数组。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">MyMouseListener mml = <span class="keyword">new</span> MyMouseListener(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">protected</span> chess[][] chess = <span class="keyword">new</span> chess[<span class="number">19</span>][<span class="number">19</span>];</span><br></pre></td></tr></table></figure>
<p>在绘制窗体方法中加入初始化棋盘代码:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initfunc</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">19</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">19</span>; j++) &#123;</span><br><span class="line">                chess[i][j] = <span class="keyword">new</span> chess(i, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.setTitle(<span class="string">"五子棋-ver0.1"</span>);</span><br><span class="line">        <span class="keyword">this</span>.setSize(<span class="number">1000</span>, <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">this</span>.setResizable(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">this</span>.setLocationRelativeTo(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">this</span>.setDefaultCloseOperation(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">this</span>.getContentPane().setBackground(<span class="keyword">new</span> Color(<span class="number">217</span>, <span class="number">207</span>, <span class="number">175</span>));</span><br><span class="line">        <span class="keyword">this</span>.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">this</span>.addMouseListener(mml);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>修改绘制棋盘棋子方法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">19</span>; i++) &#123;</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">19</span>; j++) &#123;</span><br><span class="line">         <span class="keyword">switch</span> (chess[i][j].color)&#123;</span><br><span class="line">             <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                 g.setColor(Color.BLACK);</span><br><span class="line">                 g.fillOval(chess[i][j].x - <span class="number">20</span>, chess[i][j].y - <span class="number">20</span>, <span class="number">40</span>, <span class="number">40</span>);</span><br><span class="line">                 <span class="keyword">break</span>;</span><br><span class="line">             <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                 g.setColor(Color.WHITE);</span><br><span class="line">                 g.fillOval(chess[i][j].x - <span class="number">20</span>, chess[i][j].y - <span class="number">20</span>, <span class="number">40</span>, <span class="number">40</span>);</span><br><span class="line">                 <span class="keyword">break</span>;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>然后写主类：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">mainmethod</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        initUI UI = <span class="keyword">new</span> initUI();</span><br><span class="line">        UI.initfunc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样就实现了棋子的刷新：</p>
<p><img src="/2020/08/10/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%BA%94%E5%AD%90%E6%A3%8B-1/%E4%BA%94%E5%AD%90%E6%A3%8B%E6%A3%8B%E5%AD%90.png" alt="五子棋棋子"></p>
<p>后续在研究下this.addMouseListener(mml);，mouseListener还没有理解，加深下理解在学习自动判定胜负功能。</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://blog.csdn.net/abc1498880402/article/details/80714862" target="_blank" rel="noopener">https://blog.csdn.net/abc1498880402/article/details/80714862</a>  JAVA JFrame常用方法</p>
<p><a href="https://blog.csdn.net/zp357252539/article/details/80086343" target="_blank" rel="noopener">https://blog.csdn.net/zp357252539/article/details/80086343</a>  【Java】鼠标监听器MouseListener、MouseMotionListener和MouseWheelListener的使用</p>
<p><a href="https://blog.csdn.net/thdgth/article/details/87636030?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param" target="_blank" rel="noopener">https://blog.csdn.net/thdgth/article/details/87636030?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.channel_param</a>  Java程序设计：五子棋</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
  </entry>
  <entry>
    <title>java学习笔记1——面向对象</title>
    <url>/2020/09/03/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%E2%80%94%E2%80%94%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</url>
    <content><![CDATA[<h3 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h3><p>面向对象编程有三大特性：封装、继承、多态。</p>
<a id="more"></a>

<h5 id="类的封装"><a href="#类的封装" class="headerlink" title="类的封装"></a>类的封装</h5><p>类的封装十分简单，就是创建一个类，将类的功能写完，供别的类实例化调用即可，他的作用就是隐藏功能的细节，仅提供功能，如以下代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Func</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; b; i++) &#123;</span><br><span class="line">            sum += a;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Func func = <span class="keyword">new</span> Func();</span><br><span class="line">        System.out.println(func.mul(<span class="number">3</span>,<span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个封装的类Func功能就是将两个数相乘，但是只看主函数是不知道Func是如何将两个数相乘的，有可能是直接return a * b，也有可能像上面一样，所以封装的类是隐藏了实现细节的。</p>
<h5 id="类的继承"><a href="#类的继承" class="headerlink" title="类的继承"></a>类的继承</h5><p>如果我现在想创建一个类，而且已经有一个现成的类具备了部分我想创建的类的功能，那我就可以直接继承他的所有功能，并且还可以额外增加自己的功能。</p>
<p>继承的关键字是extends，如果你想继承一个类，写法是这样的：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">zi</span> <span class="keyword">extends</span> <span class="title">fu</span></span>&#123;</span><br><span class="line">    <span class="comment">//代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样就继承了fu类，zi可以用fu类的功能，比如：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fudemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fu</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"这是父类方法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Zidemo</span> <span class="keyword">extends</span> <span class="title">Fudemo</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Zi</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"这是子类方法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Zidemo zi = <span class="keyword">new</span> Zidemo();</span><br><span class="line">        zi.Fu();</span><br><span class="line">        zi.Zi();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/09/03/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%E2%80%94%E2%80%94%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C.png" alt="执行结果"></p>
<h5 id="方法重写"><a href="#方法重写" class="headerlink" title="方法重写"></a>方法重写</h5><p>如果我想在子类里写一个和父类名称相同的方法，这种操作叫做重写。</p>
<p>要注意一点，重写的方法修饰权限必须要比原方法一致或更高。<br>而返回值类型必须与原方法范围一致或更小。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Zidemo</span> <span class="keyword">extends</span> <span class="title">Fudemo</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Zi</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"这是子类方法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fu</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"这是重写父类方法"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们重写了Fu方法，这样我们用zi.Fu()调用时就会调用我们重写的方法，</p>
<p><img src="/2020/09/03/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%E2%80%94%E2%80%94%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C2.png" alt="执行结果2"></p>
<p>@override是注解，在重写方法前写上可以检验重写是否正确（但是不写注解不影响执行）。</p>
<p>那我们在重写了方法后，还可以使用原方法吗？用super关键字就可以。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Zidemo</span> <span class="keyword">extends</span> <span class="title">Fudemo</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Zi</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"这是子类方法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fu</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.Fu();</span><br><span class="line">        System.out.println(<span class="string">"这是重写父类方法"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样我们就会在重写方法前调用原Fu方法：</p>
<p><img src="/2020/09/03/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%E2%80%94%E2%80%94%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C3.png" alt="执行结果3"></p>
<p>用super还可以调用父类的参数：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fudemo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">10</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fu</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"这是父类方法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Zidemo</span> <span class="keyword">extends</span> <span class="title">Fudemo</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">20</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Zi</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"这是子类方法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fu</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="keyword">super</span>.num);</span><br><span class="line">        System.out.println(num);</span><br><span class="line">        System.out.println(<span class="string">"这是重写父类方法"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到结果：</p>
<p><img src="/2020/09/03/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%E2%80%94%E2%80%94%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C4.png" alt="执行结果4"></p>
<p>tips：object类是所有类的父类，我们写类的时候无需写extends object</p>
<h5 id="类的多态"><a href="#类的多态" class="headerlink" title="类的多态"></a>类的多态</h5><h6 id="重载"><a href="#重载" class="headerlink" title="重载"></a>重载</h6><p>重载非常简单，即为多个方法使用相同的方法名，根据传回的参数个数和类型不同调用不同的方法，如：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">adddemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a + b + c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c, <span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a + b + c + d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        adddemo add = <span class="keyword">new</span> adddemo();</span><br><span class="line">        System.out.println(add.add(<span class="number">1</span>,<span class="number">2</span>));</span><br><span class="line">        System.out.println(add.add(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>));</span><br><span class="line">        System.out.println(add.add(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/09/03/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%E2%80%94%E2%80%94%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C5.png" alt="执行结果5"></p>
<p>构成重载的条件：</p>
<ol>
<li>参数类型不同</li>
<li>参数个数不同</li>
<li>不同类型参数顺序不同</li>
</ol>
<h6 id="向上转型"><a href="#向上转型" class="headerlink" title="向上转型"></a>向上转型</h6><p>如果现在有一个方法的参数是a类的实例，b是a类子类，那么b类的实例也可以作为参数，因为子类完全具备父类的各种特征，如平行四边形完全符合四边形的定义。</p>
<h6 id="向下转型"><a href="#向下转型" class="headerlink" title="向下转型"></a>向下转型</h6><p>四边形不一定是平行四边形，所以我们要先进行检验他是不是平行四边形，我们要用到的关键字是instanceof，这个关键字可以检验一个实例对象是否属于一个类大概用法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">四边形A <span class="keyword">instanceof</span> 平行四边形</span><br></pre></td></tr></table></figure>
<p>如果A是的话，我们还要进行一步强制转换类型，就可以了：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">平行四边形 平行四边形A = （平行四边形） 四边形A;</span><br></pre></td></tr></table></figure>

<h5 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h5><p>四边形可以是一个具体的类吗？平行四边形、矩形、梯形这些都可以是四边形的具体类，那么我们可以把四边形定义为一个抽象类，这个类的意义就是被继承，他里面的所有方法都没有任何代码，只有方法名和参数，他的意义也只是被重写。</p>
<p>定义一个抽象类的关键字是abstract，</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">classdemo</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> a. <span class="keyword">int</span> b)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样的类的唯一意义就是被继承，而且继承自他的子类必须重写里面的所有用abstract关键字的方法。</p>
<h5 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h5><p>一个类不能有多个父类，如果抽象类中有我用不到的方法，那我也只能重写，如果拿出去的话，我不能继承两个类，这时候接口就十分有用。</p>
<p>接口用interface定义：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">interface 接口名 [extends 父接口名1，父接口名2]&#123;</span><br><span class="line">    <span class="keyword">public</span> [<span class="keyword">static</span> 或 <span class="keyword">final</span>] 常量;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> 方法;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Father</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">smoking</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fishing</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Mother</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cooking</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">watchTV</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">son</span> <span class="keyword">implements</span> <span class="title">Father</span>, <span class="title">Mother</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">smoking</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我爱抽烟"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fishing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我爱钓鱼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cooking</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我爱做饭"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">watchTV</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"我爱看电视"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">main</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        son son1 = <span class="keyword">new</span> son();</span><br><span class="line">        son1.cooking();</span><br><span class="line">        son1.fishing();</span><br><span class="line">        son1.smoking();</span><br><span class="line">        son1.watchTV();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/03/java%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B01%E2%80%94%E2%80%94%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/%E6%89%A7%E8%A1%8C%E7%BB%93%E6%9E%9C6.png" alt="执行结果6"></p>
<p>可见接口可以继承多个，儿子继承了Father和Mother接口。</p>
<p>那么抽象类和接口除了继承一个和继承多个以外还有什么区别呢？</p>
<table>
<thead>
<tr>
<th></th>
<th>抽象类</th>
<th>接口</th>
</tr>
</thead>
<tbody><tr>
<td>方法</td>
<td>可以有非抽象方法</td>
<td>全为抽象方法</td>
</tr>
<tr>
<td>属性</td>
<td>可以有非静态常量</td>
<td>全为静态常量</td>
</tr>
<tr>
<td>构造方法</td>
<td>有</td>
<td>无</td>
</tr>
</tbody></table>
<h3 id="未完待续。。。"><a href="#未完待续。。。" class="headerlink" title="未完待续。。。"></a>未完待续。。。</h3>]]></content>
      <categories>
        <category>java</category>
      </categories>
  </entry>
  <entry>
    <title>openCV笔记—第一课</title>
    <url>/2020/10/11/openCV%E7%AC%94%E8%AE%B0%E2%80%94%E7%AC%AC%E4%B8%80%E8%AF%BE/</url>
    <content><![CDATA[<h3 id="加载、修改、保存和显示图像"><a href="#加载、修改、保存和显示图像" class="headerlink" title="加载、修改、保存和显示图像"></a>加载、修改、保存和显示图像</h3><p>处理图像，首先要有图像，下面介绍三个函数，分别是加载、修改和保存图像。然后介绍显示图像。</p>
<a id="more"></a>

<h4 id="加载图像"><a href="#加载图像" class="headerlink" title="加载图像"></a>加载图像</h4><p>我们要处理图像，首先要将图像加载出来，加载图像的方法是cv::imread，imread有两个参数，第一个参数表示文件的路径，第二个参数表示加载图像的类型，常用的有三种类型：<br>IMREAD_UNCHANGED(&lt;0) 表示加载原图<br>IMREAD_GRAYSCALE(0) 表示把原图作为灰度图像加载进来<br>IMREAD_COLOR(&gt;0) 表示把原图作为RGB图像加载进来</p>
<p>例：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Mat src;</span><br><span class="line">    src = imread(<span class="string">"/Users/#####/Downloads/IMG.jpg"</span>);</span><br></pre></td></tr></table></figure>

<p>第二个参数默认为RGB图像。</p>
<h4 id="修改图像"><a href="#修改图像" class="headerlink" title="修改图像"></a>修改图像</h4><p>除了加载图像，我们还可以转换图像，转换图像的办法是cv::cvtColor，cvtColor有三个参数，第一个是原图，第二个是转换后的图像，第三个是要转换成什么格式</p>
<p>例：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Mat gray_src;</span><br><span class="line">    cvtColor(src, gray_src, COLOR_BGR2GRAY);</span><br></pre></td></tr></table></figure>

<p>这样就把上面的三通道src图像转换为了单通道的gray_src图像</p>
<h4 id="保存图像"><a href="#保存图像" class="headerlink" title="保存图像"></a>保存图像</h4><p>保存图像是用cv::imwrite，imwrite有两个参数，第一个是要保存的路径，第二个是要保存的图片</p>
<p>例：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">imwrite(<span class="string">"/Users/#####/Downloads/output_image.jpg"</span>, output_image);</span><br></pre></td></tr></table></figure>

<p>这样就可以把图片保存到第一个参数的路径下了。</p>
<h4 id="显示图像"><a href="#显示图像" class="headerlink" title="显示图像"></a>显示图像</h4><p>显示图像，我们首先要创建窗体，创建窗体的方法是cv::namedWindow</p>
<p>例：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">namedWindow(<span class="string">"output"</span>, WINDOW_AUTOSIZE);</span><br></pre></td></tr></table></figure>
<p>这样我们创建了一个名字叫output的窗体，他的大小是自动的。</p>
<p>显示图像的方法是cv::imshow，我们将图像在这个窗体显示出来</p>
<p>例：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">imshow(<span class="string">"output"</span>, src);</span><br></pre></td></tr></table></figure>
<p>这样就将src图像通过output窗体显示出来。</p>
]]></content>
      <categories>
        <category>openCV</category>
      </categories>
  </entry>
  <entry>
    <title>python豆瓣top250爬虫
</title>
    <url>/2020/04/29/python%E8%B1%86%E7%93%A3top250%E7%88%AC%E8%99%AB/</url>
    <content><![CDATA[<h3 id="需要安装的库"><a href="#需要安装的库" class="headerlink" title="需要安装的库"></a>需要安装的库</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br></pre></td></tr></table></figure>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>本爬虫的目的主要是从豆瓣top250中爬取所有电影的排名、名称和简介，为此我们先去<br><a href="https://movie.douban.com/top250" target="_blank" rel="noopener">https://movie.douban.com/top250</a> 中观察源代码结构</p>
<a id="more"></a>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span> <span class="attr">class</span>=<span class="string">"grid_view"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pic"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">em</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span>1<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://movie.douban.com/subject/1292052/"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">img</span> <span class="attr">width</span>=<span class="string">"100"</span> <span class="attr">alt</span>=<span class="string">"肖申克的救赎"</span> <span class="attr">src</span>=<span class="string">"https://img3.doubanio.com/view/photo/s_ratio_poster/public/p480747492.jpg"</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"info"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"hd"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://movie.douban.com/subject/1292052/"</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>肖申克的救赎<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span><span class="symbol">&amp;nbsp;</span>/<span class="symbol">&amp;nbsp;</span>The Shawshank Redemption<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"other"</span>&gt;</span><span class="symbol">&amp;nbsp;</span>/<span class="symbol">&amp;nbsp;</span>月黑高飞(港)  /  刺激1995(台)<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"playable"</span>&gt;</span>[可播放]<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bd"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">                            导演: 弗兰克·德拉邦特 Frank Darabont<span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>主演: 蒂姆·罗宾斯 Tim Robbins /...<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                            1994<span class="symbol">&amp;nbsp;</span>/<span class="symbol">&amp;nbsp;</span>美国<span class="symbol">&amp;nbsp;</span>/<span class="symbol">&amp;nbsp;</span>犯罪 剧情</span><br><span class="line">                        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                        </span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"star"</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"rating5-t"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"rating_num"</span> <span class="attr">property</span>=<span class="string">"v:average"</span>&gt;</span>9.7<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">span</span> <span class="attr">property</span>=<span class="string">"v:best"</span> <span class="attr">content</span>=<span class="string">"10.0"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">span</span>&gt;</span>1996961人评价<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"quote"</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"inq"</span>&gt;</span>希望让人自由。<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>看着一段代码，说明了影片的信息是藏在ol里的li里面，这次我们想要爬取的分别是em里的排名信息，span class_=’title’里的名称信息和span class_=’inq’里的简介信息，如果有需要，我们也可以爬取其他标签里的信息</p>
<h3 id="代码步骤"><a href="#代码步骤" class="headerlink" title="代码步骤"></a>代码步骤</h3><h5 id="首先我们需要一个爬取网页内容的函数"><a href="#首先我们需要一个爬取网页内容的函数" class="headerlink" title="首先我们需要一个爬取网页内容的函数"></a>首先我们需要一个爬取网页内容的函数</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url, headers = kv)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span></span><br></pre></td></tr></table></figure>
<p>这个函数负责将url里的内容爬取下来，并且返回，这里的kv是一个事先定义好的字典：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">kv = &#123;<span class="string">'user-agent'</span>:<span class="string">'Mozilla/5.0'</span>&#125;</span><br></pre></td></tr></table></figure>
<p>这个是为了把我们的访问信息伪装成火狐浏览器，否则可能会被禁止访问</p>
<h5 id="其次我们需要一个解析HTML源码的函数，把这些信息从代码中找出来"><a href="#其次我们需要一个解析HTML源码的函数，把这些信息从代码中找出来" class="headerlink" title="其次我们需要一个解析HTML源码的函数，把这些信息从代码中找出来"></a>其次我们需要一个解析HTML源码的函数，把这些信息从代码中找出来</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fillList</span><span class="params">(ulist, html)</span>:</span></span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">"html.parser"</span>)</span><br><span class="line">    lis = soup.select(<span class="string">"ol li"</span>)</span><br><span class="line">    <span class="keyword">for</span> tr <span class="keyword">in</span> lis:</span><br><span class="line">        index = tr.find(<span class="string">'em'</span>).text</span><br><span class="line">        title = tr.find(<span class="string">'span'</span>, class_=<span class="string">'title'</span>).text</span><br><span class="line">        <span class="keyword">if</span> index == <span class="string">'241'</span> <span class="keyword">or</span> index == <span class="string">'247'</span> <span class="keyword">or</span> index == <span class="string">'245'</span>:</span><br><span class="line">            inq = <span class="string">" "</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            inq = tr.find(<span class="string">'span'</span>, class_=<span class="string">'inq'</span>).text</span><br><span class="line">        ulist.append([index, title, inq])</span><br></pre></td></tr></table></figure>
<p>这个函数用到了BeautifulSoup库，主要功能是把“ol li“里的各种我们需要的信息找出来，并且用列表的方式加到一个列表里，也就是列表的元素也是列表。值得注意的是，第241、245、247名电影是没有评语的，所以我加了一个判断条件，如果是这三个电影，评语就用一个空格表示，最后电影的信息以[index, title, inq]这样的形式被加到ulist列表里。</p>
<h5 id="下来是输出函数，用于将列表里的电影信息输出"><a href="#下来是输出函数，用于将列表里的电影信息输出" class="headerlink" title="下来是输出函数，用于将列表里的电影信息输出"></a>下来是输出函数，用于将列表里的电影信息输出</h5><p>我们已经获得了一个ulist列表，里面装的是我们爬取的所有信息，接下来我们用一个函数输出他：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printList</span><span class="params">(ulist)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">25</span>):</span><br><span class="line">        u = ulist[i]</span><br><span class="line">        print(<span class="string">"&#123;:^10&#125;\t&#123;:^16&#125;\t&#123;:^20&#125;"</span>.format(u[<span class="number">0</span>],u[<span class="number">1</span>],u[<span class="number">2</span>]))</span><br></pre></td></tr></table></figure>
<p>非常简单，就是简单的循环遍历</p>
<h5 id="最后，是我们的主函数"><a href="#最后，是我们的主函数" class="headerlink" title="最后，是我们的主函数"></a>最后，是我们的主函数</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    uinfo = []</span><br><span class="line">    url = <span class="string">"https://movie.douban.com/top250"</span></span><br><span class="line">    url1 = <span class="string">"https://movie.douban.com/top250"</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">250</span>, <span class="number">25</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            url1 = url + <span class="string">"?start="</span> + str(i) + <span class="string">"&amp;filter="</span></span><br><span class="line">        html = getHTMLText(url1)</span><br><span class="line">        fillList(uinfo, html)</span><br><span class="line">        printList(uinfo)</span><br><span class="line">        uinfo = []</span><br></pre></td></tr></table></figure>
<p>这段函数就是将url填入到函数里，用于三个函数的连接，要注意的是豆瓣网页上一页只有25个电影，所以我们每爬取一个网站后要在网页参数后加25，这个url在豆瓣网上可以直观的找到规律。</p>
<h5 id="接下来贴上全部的代码"><a href="#接下来贴上全部的代码" class="headerlink" title="接下来贴上全部的代码"></a>接下来贴上全部的代码</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">kv = &#123;<span class="string">'user-agent'</span>:<span class="string">'Mozilla/5.0'</span>&#125;</span><br><span class="line">print(<span class="string">"&#123;:^10&#125;\t&#123;:^16&#125;\t&#123;:^20&#125;"</span>.format(<span class="string">"排名"</span>,<span class="string">"电影名"</span>,<span class="string">"电影评语"</span>))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = requests.get(url, headers = kv)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding = r.apparent_encoding</span><br><span class="line">        <span class="keyword">return</span> r.text</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fillList</span><span class="params">(ulist, html)</span>:</span></span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">"html.parser"</span>)</span><br><span class="line">    lis = soup.select(<span class="string">"ol li"</span>)</span><br><span class="line">    <span class="keyword">for</span> tr <span class="keyword">in</span> lis:</span><br><span class="line">        index = tr.find(<span class="string">'em'</span>).text</span><br><span class="line">        title = tr.find(<span class="string">'span'</span>, class_=<span class="string">'title'</span>).text</span><br><span class="line">        <span class="keyword">if</span> index == <span class="string">'241'</span> <span class="keyword">or</span> index == <span class="string">'247'</span> <span class="keyword">or</span> index == <span class="string">'245'</span>:</span><br><span class="line">            inq = <span class="string">" "</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            inq = tr.find(<span class="string">'span'</span>, class_=<span class="string">'inq'</span>).text</span><br><span class="line">        ulist.append([index, title, inq])</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printList</span><span class="params">(ulist)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">25</span>):</span><br><span class="line">        u = ulist[i]</span><br><span class="line">        print(<span class="string">"&#123;:^10&#125;\t&#123;:^16&#125;\t&#123;:^20&#125;"</span>.format(u[<span class="number">0</span>],u[<span class="number">1</span>],u[<span class="number">2</span>]))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    uinfo = []</span><br><span class="line">    url = <span class="string">"https://movie.douban.com/top250"</span></span><br><span class="line">    url1 = <span class="string">"https://movie.douban.com/top250"</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">250</span>, <span class="number">25</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            url1 = url + <span class="string">"?start="</span> + str(i) + <span class="string">"&amp;filter="</span></span><br><span class="line">        html = getHTMLText(url1)</span><br><span class="line">        fillList(uinfo, html)</span><br><span class="line">        printList(uinfo)</span><br><span class="line">        uinfo = []</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<h5 id="最后展示下部分效果："><a href="#最后展示下部分效果：" class="headerlink" title="最后展示下部分效果："></a>最后展示下部分效果：</h5><p>排名              电影名                   电影评语<br>    1              肖申克的救赎               希望让人自由。<br>    2               霸王别姬                 风华绝代。<br>    3               阿甘正传               一部美国近现代史。<br>    4             这个杀手不太冷           怪蜀黍和小萝莉不得不说的故事。<br>    5               美丽人生                 最美的谎言。<br>    6              泰坦尼克号               失去的才是永恒的。<br>    7               千与千寻            最好的宫崎骏，最好的久石让。<br>    8              辛德勒的名单           拯救一个人，就是拯救整个世界。<br>    9               盗梦空间            诺兰给了我们一场无法盗取的梦。<br>    10            忠犬八公的故事            永远都不能忘记你所爱的人。<br>    11             海上钢琴师          每个人都要走一条自己坚定了的路，就算是粉身碎骨。<br>    12             楚门的世界          如果再也不能见到你，祝你早安，午安，晚安。<br>    13            三傻大闹宝莱坞            英俊版憨豆，高情商版谢耳朵。   </p>
<h3 id="至此，我们的豆瓣top250电影爬虫就完成了"><a href="#至此，我们的豆瓣top250电影爬虫就完成了" class="headerlink" title="至此，我们的豆瓣top250电影爬虫就完成了"></a>至此，我们的豆瓣top250电影爬虫就完成了</h3>]]></content>
      <categories>
        <category>python</category>
      </categories>
  </entry>
  <entry>
    <title>一个小有意思的图片爬虫</title>
    <url>/2020/05/04/%E4%B8%80%E4%B8%AA%E5%B0%8F%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E5%9B%BE%E7%89%87%E7%88%AC%E8%99%AB/</url>
    <content><![CDATA[<h3 id="一个小有意思的图片爬虫"><a href="#一个小有意思的图片爬虫" class="headerlink" title="一个小有意思的图片爬虫"></a>一个小有意思的图片爬虫</h3><p>爬取静态网站的图片方式其实很简单，就是将HTML页面里面的图片url找出来，并且一张张下载下来就好了，下面给出具体的做法：</p>
<a id="more"></a>

<p>首先我们打开这个网站：<a href="https://www.vmgirls.com/" target="_blank" rel="noopener">https://www.vmgirls.com/</a></p>
<p>这是他的主界面：</p>
<p><img src="/2020/05/04/%E4%B8%80%E4%B8%AA%E5%B0%8F%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E5%9B%BE%E7%89%87%E7%88%AC%E8%99%AB/web.png" alt="网站主页"></p>
<p>可见这是一个适合年轻人学习爬虫的好网站呢</p>
<h5 id="检查源代码"><a href="#检查源代码" class="headerlink" title="检查源代码"></a>检查源代码</h5><p>首先按照惯例，我们去分析网页里图片部分的源代码，这里我们爬取第一个，少女情怀总是诗里面的图片，首先我们点进去，右键一张图片，并且检查元素或者检查源代码：</p>
<p>可以看到这样的代码：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://static.vmgirls.com/image/2019/12/2019122210294290-scaled.jpeg"</span> <span class="attr">alt</span>=<span class="string">""</span> <span class="attr">data-src</span>=<span class="string">"https://static.vmgirls.com/image/2019/12/2019122210294290-scaled.jpeg"</span> <span class="attr">data-nclazyload</span>=<span class="string">"true"</span> <span class="attr">class</span>=<span class="string">"loaded"</span> <span class="attr">data-was-processed</span>=<span class="string">"true"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a href="https://static.vmgirls.com/image/2019/12/2019122210294290-scaled.jpeg" target="_blank" rel="noopener">https://static.vmgirls.com/image/2019/12/2019122210294290-scaled.jpeg</a> 这一段url即为我们要找的图片地址，我们只需要将这样的url全部找出来，并且下载到文件夹里就好了</p>
<h5 id="编写代码"><a href="#编写代码" class="headerlink" title="编写代码"></a>编写代码</h5><p>首先给出我们需要的库：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br></pre></td></tr></table></figure>
<p>其次，我们写一个函数，这个函数专门负责将网页的内容爬取下来：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span><span class="params">(url, kv)</span>:</span></span><br><span class="line"></span><br><span class="line">    r = requests.get(url, headers = kv)</span><br><span class="line">    <span class="keyword">return</span> r.text</span><br></pre></td></tr></table></figure>

<p>这段代码非常简单，仅仅就是爬取了网页的内容，其中kv是个键值对，后面会讲到用途</p>
<p>接下来我们写一个找出这些图片url的函数：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Ulist</span><span class="params">(html)</span>:</span></span><br><span class="line">    ulist = re.findall(<span class="string">'https://static\..*?\.jpeg'</span>, html)</span><br><span class="line">    <span class="keyword">return</span> ulist</span><br></pre></td></tr></table></figure>

<p>这个函数里就简单的用到了正则表达式，re.findall()这个函数在后面的博客会讲到，现在只要理解这个函数是用来表示正则表达式的，他的第一个参数即为正则表达式，后一个参数是待匹配的字符串。</p>
<p>这个正则表达式的意思是：<br>匹配开头为<a href="https://static.，中间为.*?，意思所有的字符匹配，并且为非贪婪模式，末尾是.jpeg的字符串，即为我们要爬取的图片格式" target="_blank" rel="noopener">https://static.，中间为.*?，意思所有的字符匹配，并且为非贪婪模式，末尾是.jpeg的字符串，即为我们要爬取的图片格式</a></p>
<p>接下来我们写一个将这些url下载到文件夹里面的函数：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(info, i, kv)</span>:</span></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> info:</span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            file_name = url.split(<span class="string">'/'</span>)[<span class="number">-1</span>]</span><br><span class="line">            print(<span class="string">f"现在正在爬取第<span class="subst">&#123;i + <span class="number">1</span>&#125;</span>页第<span class="subst">&#123;j&#125;</span>张照片"</span>)</span><br><span class="line">            res = requests.get(url, headers = kv)</span><br><span class="line">            <span class="keyword">with</span> open(file_name, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(res.content)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>

<p>这段代码即为吧图片存到文件夹里，其中主要的就是try里面这一段，</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">file_name = url.split(<span class="string">'/'</span>)[<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>
<p>这一段为给图片起个名字，这里图方便就直接用url里最后一个\后面的内容，这个是字符串的基本操作</p>
<p>接下来就是打开文件，写入文件里了，res.content是图片的二进制格式，我们直接将它写到文件里，如果有的url报错，没有下载下来，那么会跳转到except执行，即continue</p>
<p>最后是主函数，主函数负责url的翻页操作，还有headers的伪装：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    url = <span class="string">'https://www.vmgirls.com/13344.html'</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">        user = <span class="string">'Mozilla'</span> + str(i)</span><br><span class="line">        kv = &#123;<span class="string">'user-agent'</span>: user&#125;</span><br><span class="line">        html = getHTMLText(url, kv)</span><br><span class="line">        info = Ulist(html)</span><br><span class="line">        save(info, i, kv)</span><br><span class="line">        url = <span class="string">'https://www.vmgirls.com/13344/page-'</span> + str(i + <span class="number">1</span>) + <span class="string">'.html'</span></span><br></pre></td></tr></table></figure>

<p>首先这个网页有7页，后面的url即为最开始的url里面加入page-页码，用上述的循环条件进行每一页的爬取</p>
<p>kv是一个伪装头，他会告诉网站我不是爬虫，实测如果只用一个头会被禁止访问，所以再循环里我们改变一下(也不确定是不是这个问题，不过改过后确实解决了被禁的问题)，</p>
<h5 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h5><p>这里给出源代码：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHTMLText</span><span class="params">(url, kv)</span>:</span></span><br><span class="line"></span><br><span class="line">    r = requests.get(url, headers = kv)</span><br><span class="line">    <span class="keyword">return</span> r.text</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Ulist</span><span class="params">(html)</span>:</span></span><br><span class="line">    ulist = re.findall(<span class="string">'https://static\..*?\.jpeg'</span>, html)</span><br><span class="line">    <span class="keyword">return</span> ulist</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(info, i, kv)</span>:</span></span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> info:</span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            file_name = url.split(<span class="string">'/'</span>)[<span class="number">-1</span>]</span><br><span class="line">            print(<span class="string">f"现在正在爬取第<span class="subst">&#123;i + <span class="number">1</span>&#125;</span>页第<span class="subst">&#123;j&#125;</span>张照片"</span>)</span><br><span class="line">            res = requests.get(url, headers = kv)</span><br><span class="line">            <span class="keyword">with</span> open(file_name, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(res.content)</span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    url = <span class="string">'https://www.vmgirls.com/13344.html'</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">        user = <span class="string">'Mozilla'</span> + str(i)</span><br><span class="line">        kv = &#123;<span class="string">'user-agent'</span>: user&#125;</span><br><span class="line">        html = getHTMLText(url, kv)</span><br><span class="line">        info = Ulist(html)</span><br><span class="line">        save(info, i, kv)</span><br><span class="line">        url = <span class="string">'https://www.vmgirls.com/13344/page-'</span> + str(i + <span class="number">1</span>) + <span class="string">'.html'</span></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<h5 id="成果展示"><a href="#成果展示" class="headerlink" title="成果展示"></a>成果展示</h5><p><img src="/2020/05/04/%E4%B8%80%E4%B8%AA%E5%B0%8F%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E5%9B%BE%E7%89%87%E7%88%AC%E8%99%AB/%E6%88%90%E6%9E%9C%E5%B1%95%E7%A4%BA.png" alt="成果展示"></p>
<h3 id="我们的这个爬虫就到此完成"><a href="#我们的这个爬虫就到此完成" class="headerlink" title="我们的这个爬虫就到此完成"></a>我们的这个爬虫就到此完成</h3><p>值得注意的是每个网页里都有重复的图片，我们爬下来时因为名字是相同的，所以被覆盖了</p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
  </entry>
  <entry>
    <title>初音未来2020贺图</title>
    <url>/2020/08/31/%E5%88%9D%E9%9F%B3%E6%9C%AA%E6%9D%A52020%E8%B4%BA%E5%9B%BE/</url>
    <content><![CDATA[<h3 id="初音未来13周年贺图！！"><a href="#初音未来13周年贺图！！" class="headerlink" title="初音未来13周年贺图！！"></a>初音未来13周年贺图！！</h3><p><a href="https://www.pixiv.net/artworks/84057515" target="_blank" rel="noopener">https://www.pixiv.net/artworks/84057515</a></p>
<a id="more"></a>

<p><img src="/2020/08/31/%E5%88%9D%E9%9F%B3%E6%9C%AA%E6%9D%A52020%E8%B4%BA%E5%9B%BE/cy2020.jpg" alt="cy2020"></p>
]]></content>
      <categories>
        <category>painting</category>
      </categories>
  </entry>
  <entry>
    <title>放几张画的画^~^</title>
    <url>/2020/05/04/%E6%94%BE%E5%87%A0%E5%BC%A0%E7%94%BB%E7%9A%84%E7%94%BB/</url>
    <content><![CDATA[<h3 id="放几张画，记录一下"><a href="#放几张画，记录一下" class="headerlink" title="放几张画，记录一下"></a>放几张画，记录一下</h3><p>我的P站ID：14255525<br>昵称：smril</p>
<a id="more"></a>

<h5 id="下面是最近画的三幅画～"><a href="#下面是最近画的三幅画～" class="headerlink" title="下面是最近画的三幅画～"></a>下面是最近画的三幅画～</h5><p>p站地址：<a href="https://www.pixiv.net/artworks/81241591" target="_blank" rel="noopener">https://www.pixiv.net/artworks/81241591</a><br>p站地址：<a href="https://www.pixiv.net/artworks/79442962" target="_blank" rel="noopener">https://www.pixiv.net/artworks/79442962</a><br>p站地址：<a href="https://www.pixiv.net/artworks/76539307" target="_blank" rel="noopener">https://www.pixiv.net/artworks/76539307</a></p>
<p><img src="/2020/05/04/%E6%94%BE%E5%87%A0%E5%BC%A0%E7%94%BB%E7%9A%84%E7%94%BB/%E4%B8%8D%E7%9F%A5%E7%81%AB.jpg" alt="不知火"></p>
<p><img src="/2020/05/04/%E6%94%BE%E5%87%A0%E5%BC%A0%E7%94%BB%E7%9A%84%E7%94%BB/%E5%BE%A1%E5%9D%82%E7%BE%8E%E7%90%B4.jpg" alt="御坂美琴"></p>
<p><img src="/2020/05/04/%E6%94%BE%E5%87%A0%E5%BC%A0%E7%94%BB%E7%9A%84%E7%94%BB/%E5%88%9D%E9%9F%B3%E6%9C%AA%E6%9D%A5.jpg" alt="初音未来"></p>
]]></content>
      <categories>
        <category>painting</category>
      </categories>
  </entry>
  <entry>
    <title>数据库课程设计学习记录一</title>
    <url>/2020/05/14/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%B8%80/</url>
    <content><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>实践内容 实验室设备管理系统<br>建立一个实验室设备管理系统, 编写应用程序完成系统开发。</p>
<a id="more"></a>
<ol>
<li>建立基本表：<br>设备表（设备号，设备名称，价格，配置，厂家名称，出厂日期，实验室名）<br>故障设备信息表（故障序号，故障名称，设备号，故障日期，故障信息，经手人）<br>维修表（维修号，设备号，故障序号，维修日期，维修内容，改变配置，维修金额，维修人，备注）<br>用户表（用户号，用户名，密码，用户类别）</li>
<li>要求实现以下功能：<br>（1）登录功能<br>  系统有四类用户：一般用户、管理员、维修员、系统管理员<br>（2）设备基本信息管理<br>  要求：设备基本信息查询，单个/批量设备添加，单个/批量设备信息修改，单个/批量设备信息删除<br>（3）故障设备信息管理<br> 要求：故障查询，添加故障设备，修改故障设备信息，删除故障设备信息；维修信息查询，维修信息添加<br>（4）用户管理<br>  要求：用户信息查询，用户注册，用户信息维护，用户权限修改<br>（5）报表信息管理<br>（6) 系统维护</li>
</ol>
<h3 id="准备环境"><a href="#准备环境" class="headerlink" title="准备环境"></a>准备环境</h3><p>这次为了避免出错，而且为了和更多的教程契合，所以我用了Windows系统，其中需要准备的环境是wampserver和thinkphp，其中wampserver是一个网页服务器集成开发环境，它包含了apache，php,mySQL，所以以上都不用单独安装，如果以前安装过某些网页服务器或数据库，如IIS和mySQL，可能会造成冲突报错，把以前安装过的停掉就好了。</p>
<p>wampserver下载连接：<a href="http://www.wampserver.com" target="_blank" rel="noopener">http://www.wampserver.com</a> tips:这个要科学上网<br>thinkphp下载连接：<a href="http://www.thinkphp.cn" target="_blank" rel="noopener">http://www.thinkphp.cn</a></p>
<p>将thinkphp整个文件解压到wamp64目录下的www目录里，单独有一个文件夹用来放thinkphp解压内容。</p>
<p>最终的效果是wampserver图标变绿，即三个服务都已经开启，在浏览器里输入localhost，就可以看到主界面，点击放thinkphp的文件夹，会看到类似FTP服务器的界面，点击public，看到“十年磨一剑，高性能的#¥%”字样，就说明准备工作成功了。</p>
<p>这里最大的问题是wampserver怎么变绿，大多数问题即为80端口被占，或者原来的mysql服务没有关闭，80端口被占可以在httpd.conf里更改监听端口，但是注意更改后localhost后要加:端口号，例：localhost:8080，在点击thinkphp文件夹后，默认是不加端口号的，仍然要手动添加。关闭原来的mysql服务，可以右击我的电脑-管理-服务，找到mysql，停止即可。</p>
]]></content>
      <categories>
        <category>数据库课程设计</category>
      </categories>
  </entry>
  <entry>
    <title>数据库课程设计学习记录三</title>
    <url>/2020/05/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%B8%89/</url>
    <content><![CDATA[<h3 id="查询数据、修改数据和删除数据"><a href="#查询数据、修改数据和删除数据" class="headerlink" title="查询数据、修改数据和删除数据"></a>查询数据、修改数据和删除数据</h3><p>这里讲述如何查询数据表里的数据以及修改和删除数据</p>
<a id="more"></a>

<h5 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h5><p>首先我们要在和插入数据的网页的同一个文件夹下新建里一个用来查询的HTML文件，我起名为list.html，然后回到控制器里添加一个list方法，用来渲染输出这个模版文件，list方法的代码为：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$data = UserModel::paginate(<span class="number">3</span>);</span><br><span class="line">        $page = $data-&gt;render();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;assign(<span class="string">'data'</span>,$data);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;assign(<span class="string">'page'</span>,$page);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;fetch();</span><br></pre></td></tr></table></figure>

<p>这里的第一行paginate里面的参数是指一页内有几条数据，下面是向list.html模版里传入两个参数，一个是$data, 一个是$page。</p>
<p>接下来是list.html网页内容的书写：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-cn"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"renderer"</span> <span class="attr">content</span>=<span class="string">"webkit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>设备信息查询<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/jquery.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/pintuer.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel admin-panel"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-head"</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span> <span class="attr">class</span>=<span class="string">"icon-reorder"</span>&gt;</span> 用户列表<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"float:right"</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span> <span class="attr">class</span>=<span class="string">"icon-reorder"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"yonghu"</span>&gt;</span> 添加管理员<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-hover text-center"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">"0%"</span>&gt;</span>设备号<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">"0%"</span>&gt;</span>设备名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">"0%"</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">"0%"</span>&gt;</span>配置<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">"0%"</span>&gt;</span>厂家名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">"0%"</span>&gt;</span>出厂日期<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">"0%"</span>&gt;</span>实验室名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">&#123;foreach $data as $value&#125;</span><br><span class="line"> <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;$value.shebeihao&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span>     </span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;$value.shebeimingcheng&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span>     </span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;$value.jiage&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;$value.peizhi&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;$value.changjiamingcheng&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;$value.chuchangriqi&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;$value.shiyanshiming&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"button-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"button border-main"</span> <span class="attr">href</span>=<span class="string">"edit?shebeihao=&#123;$value.shebeihao&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-edit"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> 修改<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"button border-red"</span> <span class="attr">href</span>=<span class="string">"delete?shebeihao=&#123;$value.shebeihao&#125;"</span> &gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-trash-o"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> 删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">&#123;/foreach&#125;</span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span>&#123;$page&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这样当我们访问list方法时，就可以看到我们的数据了。</p>
<p><img src="/2020/05/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%B8%89/list.png" alt="信息列表"></p>
<h5 id="修改数据"><a href="#修改数据" class="headerlink" title="修改数据"></a>修改数据</h5><p>其中</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"button border-main"</span> <span class="attr">href</span>=<span class="string">"edit?shebeihao=&#123;$value.shebeihao&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-edit"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> 修改<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"button border-red"</span> <span class="attr">href</span>=<span class="string">"delete?shebeihao=&#123;$value.shebeihao&#125;"</span> &gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-trash-o"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> 删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这两行提供了修改和删除的按钮，点击他们，就会进入到控制器的edit和delete方法，并且传回主键的参数，接下来我们返回控制器来写edit方法：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">edit</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $shebeihao = input(<span class="string">'get.shebeihao'</span>);</span><br><span class="line">        $data = UserModel::get($shebeihao);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;assign(<span class="string">'data'</span>,$data);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;fetch();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这里前面接收了主键信息，后来又把信息传到了edit.html里，我们去写edit.html文件：</p>
<p>在上述HTML文件下建立一个edit.html文件，里面写入：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-cn"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"renderer"</span> <span class="attr">content</span>=<span class="string">"webkit"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>修改设备信息<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/jquery.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/pintuer.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel admin-panel margin-top"</span> <span class="attr">id</span>=<span class="string">"shebei"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-head"</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-pencil-square-o"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> 修改设备信息<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"body-content"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">class</span>=<span class="string">"form-x"</span> <span class="attr">action</span>=<span class="string">"update"</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"shebeihao"</span> <span class="attr">value</span>=<span class="string">"&#123;$data.shebeihao&#125;"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">label</span>&gt;</span>设备号<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input w50"</span> <span class="attr">value</span>=<span class="string">"&#123;$data.shebeihao&#125;"</span> <span class="attr">name</span>=<span class="string">"shebeihao"</span> <span class="attr">data-validate</span>=<span class="string">"required:设备名不能为空"</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">label</span>&gt;</span>设备名称<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input w50"</span> <span class="attr">name</span>=<span class="string">"shebeimingcheng"</span> <span class="attr">value</span>=<span class="string">"&#123;$data.shebeimingcheng&#125;"</span>  <span class="attr">data-validate</span>=<span class="string">"required:设备名称不能为空"</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">label</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input w50"</span> <span class="attr">name</span>=<span class="string">"jiage"</span> <span class="attr">value</span>=<span class="string">"&#123;$data.jiage&#125;"</span>  <span class="attr">data-validate</span>=<span class="string">"required:价格不能为空"</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">label</span>&gt;</span>配置<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"peizhi"</span>  <span class="attr">value</span>=<span class="string">"&#123;$data.peizhi&#125;"</span> <span class="attr">data-validate</span>=<span class="string">"required:配置不能为空"</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">label</span>&gt;</span>厂家名称<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"changjiamingcheng"</span>  <span class="attr">value</span>=<span class="string">"&#123;$data.changjiamingcheng&#125;"</span> <span class="attr">data-validate</span>=<span class="string">"required:厂家名称不能为空"</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">label</span>&gt;</span>出厂日期<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"chuchangriqi"</span>  <span class="attr">value</span>=<span class="string">"&#123;$data.chuchangriqi&#125;"</span> <span class="attr">data-validate</span>=<span class="string">"required:出厂日期不能为空"</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">label</span>&gt;</span>实验室名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input"</span> <span class="attr">name</span>=<span class="string">"shiyanshiming"</span>  <span class="attr">value</span>=<span class="string">"&#123;$data.shiyanshiming&#125;"</span> <span class="attr">data-validate</span>=<span class="string">"required:实验室名不能为空"</span>/&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"button bg-main icon-check-square-o"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span> 提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到这个页面和插入界面很像，我们在这里输入要修改的信息。</p>
<p><img src="/2020/05/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%B8%89/%E4%BF%AE%E6%94%B9%E7%95%8C%E9%9D%A2.png" alt="修改界面"></p>
<p>但是现在提交会报错，因为HTML里面写着</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">class</span>=<span class="string">"form-x"</span> <span class="attr">action</span>=<span class="string">"update"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>说明点击提交后，会执行update方法，所以我们去控制器里写入update方法：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $data = input(<span class="string">'post.'</span>);</span><br><span class="line">        $shebeihao = input(<span class="string">'post.shebeihao'</span>);</span><br><span class="line">        $valyong = <span class="keyword">new</span> UserValidate();</span><br><span class="line">        <span class="keyword">if</span> (!$valyong-&gt;check($data))&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;error($valyong-&gt;getError());</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $user = <span class="keyword">new</span> UserModel();</span><br><span class="line">        $ret = $user-&gt;allowField(<span class="keyword">true</span>)-&gt;save($data,[<span class="string">'shebeihao'</span>=&gt;$shebeihao]);</span><br><span class="line">        <span class="keyword">if</span>($ret)&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;success(<span class="string">'修改设备信息成功'</span>,<span class="string">'Shebei/list'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;error(<span class="string">'修改设备信息失败'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这个方法中，我们先将修改后的数据传回来，然后使用验证器验证数据的格式是否正确，然后将其更新到对应主键的一行里，完成修改。</p>
<p><img src="/2020/05/22/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%B8%89/%E4%BF%AE%E6%94%B9%E6%88%90%E5%8A%9F.png" alt="修改成功"></p>
<h5 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h5><p>删除数据需要在控制器中定义delete方法：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">delete</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $shebeihao = input(<span class="string">'get.shebeihao'</span>);</span><br><span class="line">        $ret = UserModel::destroy($shebeihao);</span><br><span class="line">        <span class="keyword">if</span>($ret)&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;success(<span class="string">'删除用户成功'</span>,<span class="string">'Shebei/list'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;error(<span class="string">'删除用户失败'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>删除方法里首先将主键信息传回来，然后使用destroy方法删除即可。</p>
<h5 id="重复步骤"><a href="#重复步骤" class="headerlink" title="重复步骤"></a>重复步骤</h5><p>然后按照同样的方式建立起4张基本表的增删改查方法，即完成了课设作业的第一步。</p>
]]></content>
      <categories>
        <category>数据库课程设计</category>
      </categories>
  </entry>
  <entry>
    <title>数据库课程设计学习记录二</title>
    <url>/2020/05/20/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BA%8C/</url>
    <content><![CDATA[<h3 id="插入一条数据"><a href="#插入一条数据" class="headerlink" title="插入一条数据"></a>插入一条数据</h3><p>这里讲述如何向数据库里插入数据</p>
<a id="more"></a>

<h5 id="基本设置"><a href="#基本设置" class="headerlink" title="基本设置"></a>基本设置</h5><p>首先我们在application下新建一个模块(文件夹)，我起名为keshe，然后在模块下新建四个文件夹，controller, model, validate, view, 这四个文件夹分别对应控制器，模型，验证器和视图，我们首先在model下新建一个文件，命名首字母需要大写，里面的内容为：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">SoftDelete</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shebei</span> <span class="keyword">extends</span> <span class="title">Model</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>class后的类名要和文件名保持一致，这里的类名即为数据表的名字</p>
<p>然后我们在controller文件夹下创建一个User.php，用来控制插入数据，在php文件里写入：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">model</span>\<span class="title">Shebei</span> <span class="title">as</span> <span class="title">UserModel</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">validate</span>\<span class="title">Val</span> <span class="title">as</span> <span class="title">UserValidate</span>;</span><br></pre></td></tr></table></figure>
<p>这段代码是引用了一些东西，并且给他们起了别名，注意这里的路径，都是我们本模块下的文件,接着我们写入控制器方法：</p>
<h5 id="控制器方法"><a href="#控制器方法" class="headerlink" title="控制器方法"></a>控制器方法</h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Shebei</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;fetch();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">insert</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $data = input(<span class="string">'post.'</span>);</span><br><span class="line">        $val = <span class="keyword">new</span> UserValidate();</span><br><span class="line">        <span class="keyword">if</span> (!$val-&gt;check($data))&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;error($val-&gt;getError());</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $user = <span class="keyword">new</span> UserModel($data);</span><br><span class="line">        $ret = $user-&gt;allowField(<span class="keyword">true</span>)-&gt;save();</span><br><span class="line">        <span class="keyword">if</span>($ret)&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt; success(<span class="string">'插入成功'</span>,<span class="string">'Shebei'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;error(<span class="string">'插入失败'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码里有两个方法，一个是Shebei方法，是直接返回view里的内容，另一个是insert方法，用来插入数据，开始先将视图模版里用户输入的数据用post方法传给$data，接下来是一个验证输入内容的验证器，用来调用validate里的php文件检验输入的数据是否有误。</p>
<h5 id="验证器方法"><a href="#验证器方法" class="headerlink" title="验证器方法"></a>验证器方法</h5><p>在validate文件夹下建立一个新的文件叫做Val.php, 命名无所谓，但首字母要大写，也要和上面的控制器里的命名保持一致</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">validate</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Validate</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Val</span> <span class="keyword">extends</span> <span class="title">Validate</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $rule = [</span><br><span class="line">        <span class="string">'shebeihao|设备号'</span>=&gt;<span class="string">'require'</span>,</span><br><span class="line">        <span class="string">'shebeimingcheng|投影仪'</span>=&gt;<span class="string">'require'</span>,</span><br><span class="line">        <span class="string">'jiage|价格'</span>=&gt;<span class="string">'require'</span>,</span><br><span class="line">        <span class="string">'peizhi|配置'</span>=&gt;<span class="string">'require'</span>,</span><br><span class="line">        <span class="string">'changjiamingcheng|厂家名称'</span>=&gt;<span class="string">'require'</span>,</span><br><span class="line">        <span class="string">'chuchangriqi|出厂日期'</span>=&gt;<span class="string">'require'</span>,</span><br><span class="line">        <span class="string">'shiyanshiming|实验室名'</span>=&gt;<span class="string">'require'</span>,</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">protected</span> $message = [</span><br><span class="line">        <span class="string">'shebeihao.require'</span>=&gt;<span class="string">'邮箱不能为空！'</span>,</span><br><span class="line">        <span class="string">'shebeimingcheng.require'</span>=&gt;<span class="string">'设备名称不能为空！'</span>,</span><br><span class="line">        <span class="string">'jiage.require'</span>=&gt;<span class="string">'价格不能为空！'</span>,</span><br><span class="line">        <span class="string">'peizhi.require'</span>=&gt;<span class="string">'配置不能为空！'</span>,</span><br><span class="line">        <span class="string">'changjiamingcheng.require'</span>=&gt;<span class="string">'厂家名称不能为空！'</span>,</span><br><span class="line">        <span class="string">'chuchangriqi.require'</span>=&gt;<span class="string">'出厂日期不能为空！'</span>,</span><br><span class="line">        <span class="string">'shiyanshiming.require'</span>=&gt;<span class="string">'实验室名不能为空！'</span>,</span><br><span class="line">    ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这一段即为validate验证器里的代码，可以看到所有的验证规则和不符合的提示信息，require即不为空，还有min、max等操作，注意类名和文件名保持一致</p>
<h5 id="网页代码"><a href="#网页代码" class="headerlink" title="网页代码"></a>网页代码</h5><p>然后我们在view下新建一个文件夹，命名和控制器里的类名要保持一致，然后在其中建立一个HTML网页，命名和控制器的方法保持一致，然后用HTML代码写出各个提交表单的窗口</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>添加设备信息<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">class</span>=<span class="string">"form-x"</span> <span class="attr">action</span>=<span class="string">"insert"</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">label</span>&gt;</span>设备号<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input  w50"</span> <span class="attr">name</span>=<span class="string">"shebeihao"</span>  <span class="attr">value</span>=<span class="string">""</span> <span class="attr">data-validate</span>=<span class="string">"required:请输入设备号！"</span>/&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span>  </span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span>&gt;</span>设备名称<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input w50"</span> <span class="attr">name</span>=<span class="string">"shebeimingcheng"</span> <span class="attr">value</span>=<span class="string">""</span>  <span class="attr">data-validate</span>=<span class="string">"required:请输入设备名称！"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input w50"</span> <span class="attr">name</span>=<span class="string">"jiage"</span> <span class="attr">value</span>=<span class="string">""</span>  <span class="attr">data-validate</span>=<span class="string">"required:请输入价格！"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">label</span>&gt;</span>配置<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input w50"</span> <span class="attr">name</span>=<span class="string">"peizhi"</span> <span class="attr">value</span>=<span class="string">""</span>  <span class="attr">data-validate</span>=<span class="string">"required:请输入配置！"</span>/&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">label</span>&gt;</span>厂家名称<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input w50"</span> <span class="attr">name</span>=<span class="string">"changjiamingcheng"</span> <span class="attr">value</span>=<span class="string">""</span>  <span class="attr">data-validate</span>=<span class="string">"required:请输入厂家名称！"</span>/&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">label</span>&gt;</span>出厂日期<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input w50"</span> <span class="attr">name</span>=<span class="string">"chuchangriqi"</span> <span class="attr">value</span>=<span class="string">""</span>  <span class="attr">data-validate</span>=<span class="string">"required:请输入出厂日期！"</span>/&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">label</span>&gt;</span>实验室名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input w50"</span> <span class="attr">name</span>=<span class="string">"shiyanshiming"</span> <span class="attr">value</span>=<span class="string">""</span>  <span class="attr">data-validate</span>=<span class="string">"required:请输入实验室名！"</span>/&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tips"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"button bg-main icon-check-square-o"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span> 提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="建立数据库"><a href="#建立数据库" class="headerlink" title="建立数据库"></a>建立数据库</h5><p>用phpadmin或者命令行建立一个和要求一致的数据表，然后在database.php里将数据库名和前缀指到这个数据库。</p>
<h5 id="完成插入操作"><a href="#完成插入操作" class="headerlink" title="完成插入操作"></a>完成插入操作</h5><p>再然后，我们就将数据插入到数据库里，并检验是否插入成功。如果插入成功，会弹出插入成功字样，并且跳转到Shebei.html。</p>
<p><img src="/2020/05/20/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BA%8C/%E6%8F%92%E5%85%A5%E6%88%90%E5%8A%9F.png" alt="插入成功"></p>
<h3 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h3><p>到这里插入工作就完成了，查看数据库即可发现多出来的数据，做这个操作最多的错误即为命名问题，一定要注意首字母大写问题和命名一致问题。application文件夹是在wamp64下的www目录下的thinkphp文件里。</p>
]]></content>
      <categories>
        <category>数据库课程设计</category>
      </categories>
  </entry>
  <entry>
    <title>数据库课程设计学习记录五</title>
    <url>/2020/05/23/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BA%94/</url>
    <content><![CDATA[<h3 id="不同用户的跳转"><a href="#不同用户的跳转" class="headerlink" title="不同用户的跳转"></a>不同用户的跳转</h3><p>一定要理清自己的控制器结构和关系，要不然就会乱到自暴自弃:(</p>
<a id="more"></a>

<h5 id="明确用户类别"><a href="#明确用户类别" class="headerlink" title="明确用户类别"></a>明确用户类别</h5><p>我用数字代表用户类别，0代表系统管理员，他拥有最高权限，可以访问并修改删除一切数据，接下来1是用户管理员，他只可以访问并修改用户表，2是维修员，他可以访问设备表，并访问修改故障设备表和维修表(这里只做完了维修表),3是普通用户，他只可以访问设备表。</p>
<h5 id="整理文件结构"><a href="#整理文件结构" class="headerlink" title="整理文件结构"></a>整理文件结构</h5><p>开始的文件结构十分混乱，在经历了一番整理后，主要的目录功能如下：<br>控制器Login.php负责登录界面、后台管理界面，用户表界面，Weixiu.php负责维修表界面，Guzhang.php负责故障设备表界面，Search.php负责设备表界面。</p>
<h5 id="不同用户访问"><a href="#不同用户访问" class="headerlink" title="不同用户访问"></a>不同用户访问</h5><p>首先是登录界面，我们进入登录界面：</p>
<p><img src="/2020/05/23/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BA%94/%E7%99%BB%E9%99%86%E7%95%8C%E9%9D%A2.png" alt="登录界面"></p>
<p>然后在登录界面输入用户信息，然后在Login.php下会判断输入的用户类别，跳转到不同的界面，具体的方法如下：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $data = input(<span class="string">'post.'</span>);</span><br><span class="line">        $user = <span class="keyword">new</span> UserModel();</span><br><span class="line">        $result = $user-&gt;where(<span class="string">'yonghuhao'</span>,$data[<span class="string">'yonghuhao'</span>])-&gt;find();</span><br><span class="line">        <span class="keyword">if</span>($result)&#123;</span><br><span class="line">            <span class="keyword">if</span>($result[<span class="string">'mima'</span>] === $data[<span class="string">'mima'</span>])&#123;</span><br><span class="line">                session(<span class="string">'yonghuhao'</span>,$data[<span class="string">'yonghuhao'</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;error(<span class="string">'密码不正确'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;error(<span class="string">'用户名不存在'</span>);</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(captcha_check($data[<span class="string">'code'</span>]))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>($result[<span class="string">'yonghuleibie'</span>] === <span class="number">0</span>)</span><br><span class="line">                &#123;<span class="keyword">$this</span>-&gt;success(<span class="string">'登录成功！'</span>,<span class="string">'login/index'</span>);&#125;</span><br><span class="line">            <span class="keyword">if</span>($result[<span class="string">'yonghuleibie'</span>] === <span class="number">1</span>)</span><br><span class="line">                &#123;<span class="keyword">$this</span>-&gt;success(<span class="string">'登录成功！'</span>,<span class="string">'login/list'</span>);&#125;</span><br><span class="line">            <span class="keyword">if</span>($result[<span class="string">'yonghuleibie'</span>] === <span class="number">2</span>)</span><br><span class="line">                &#123;<span class="keyword">$this</span>-&gt;success(<span class="string">'登录成功！'</span>,<span class="string">'weixiu/list'</span>);&#125; </span><br><span class="line">            <span class="keyword">if</span>($result[<span class="string">'yonghuleibie'</span>] === <span class="number">3</span>)</span><br><span class="line">                &#123;<span class="keyword">$this</span>-&gt;success(<span class="string">'登录成功！'</span>,<span class="string">'search/list'</span>);&#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;error(<span class="string">'用户类别有误！'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;error(<span class="string">'验证码不正确'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>可以看到里面的判断界面，不同的用户会跳转到不同的表里。</p>
<p>例如你登录的用户号用户类别为1，则意味着他可以查看和修改用户表：</p>
<p><img src="/2020/05/23/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BA%94/%E7%94%A8%E6%88%B7%E8%A1%A8.png" alt="用户表"></p>
<h5 id="系统管理员"><a href="#系统管理员" class="headerlink" title="系统管理员"></a>系统管理员</h5><p>系统管理员的权限最大，所以他有权访问上面的用户的任何一张表，于是跳转到主界面：</p>
<p><img src="/2020/05/23/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BA%94/%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%981.png" alt="系统管理员1"><br><img src="/2020/05/23/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BA%94/%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%982.png" alt="系统管理员2"><br><img src="/2020/05/23/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BA%94/%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%983.png" alt="系统管理员3"></p>
<p>这里每个选项需要调用不同模块下的表，所以我采用了success方法，这样就可以跨控制器调用方法:</p>
<p>但是有个尴尬的地方，每次点击都得等3秒：</p>
<p><img src="/2020/05/23/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E4%BA%94/%E7%AD%89%E5%BE%85.png" alt="等待"></p>
<p>其中index.html，也就是系统管理员界面的代码是这样的：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-cn"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"renderer"</span> <span class="attr">content</span>=<span class="string">"webkit"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>后台管理中心<span class="tag">&lt;/<span class="name">title</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/jquery.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">"background-color:#f2f9fd;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"header bg-main"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"logo margin-big-left fadein-top"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/images/y.jpg"</span> <span class="attr">class</span>=<span class="string">"radius-circle rotate-hover"</span> <span class="attr">height</span>=<span class="string">"50"</span> <span class="attr">alt</span>=<span class="string">""</span> /&gt;</span>后台管理中心<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"head-l"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"button button-little bg-green"</span> <span class="attr">href</span>=<span class="string">"&#123;:url('keshe/Login/index')&#125;"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-home"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> 前台首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"##"</span> <span class="attr">class</span>=<span class="string">"button button-little bg-blue"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-wrench"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> 清除缓存<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"button button-little bg-red"</span> <span class="attr">href</span>=<span class="string">"&#123;:url('admin/Index/logout')&#125;"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-power-off"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> 退出登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"leftnav"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"leftnav-title"</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-list"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>菜单列表<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-user"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>基本设置<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">style</span>=<span class="string">"display:block"</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"list"</span> <span class="attr">target</span>=<span class="string">"right"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-caret-right"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>用户管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"shebei"</span> <span class="attr">target</span>=<span class="string">"right"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-caret-right"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>设备管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"guzhang"</span> <span class="attr">target</span>=<span class="string">"right"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-caret-right"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>故障管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>     </span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"weixiu"</span> <span class="attr">target</span>=<span class="string">"right"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon-caret-right"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>维修管理<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">  $(<span class="string">".leftnav h2"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">	  $(<span class="keyword">this</span>).next().slideToggle(<span class="number">200</span>);	</span></span><br><span class="line"><span class="javascript">	  $(<span class="keyword">this</span>).toggleClass(<span class="string">"on"</span>); </span></span><br><span class="line">  &#125;)</span><br><span class="line"><span class="javascript">  $(<span class="string">".leftnav ul li a"</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">	    $(<span class="string">"#a_leader_txt"</span>).text($(<span class="keyword">this</span>).text());</span></span><br><span class="line"><span class="javascript">  		$(<span class="string">".leftnav ul li a"</span>).removeClass(<span class="string">"on"</span>);</span></span><br><span class="line"><span class="javascript">		$(<span class="keyword">this</span>).addClass(<span class="string">"on"</span>);</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"bread"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;:url('keshe/Yonghu/list')&#125;"</span> <span class="attr">target</span>=<span class="string">"right"</span> <span class="attr">class</span>=<span class="string">"icon-home"</span>&gt;</span> 首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"admin"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">scrolling</span>=<span class="string">"auto"</span> <span class="attr">rameborder</span>=<span class="string">"0"</span> <span class="attr">src</span>=<span class="string">"yonghu\list.html"</span> <span class="attr">name</span>=<span class="string">"right"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"text-align:center;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当然这个文件里有大量的CSS样式，因为是网上的模版，所以代码太多了，这里不表，可以看到点击用户管理，他会调用list方法，点击设备管理他会调用shebei方法，所以我们在Login.php方法里写入这些方法，并且让这些方法指向对应的表，即可在这个界面呈现所有的表：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">shebei</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;success(<span class="string">''</span>,<span class="string">'search/list'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">weixiu</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;success(<span class="string">''</span>,<span class="string">'weixiu/list'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">guzhang</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;success(<span class="string">''</span>,<span class="string">'guzhang/list'</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>因为list方法调用的用户信息模版就在view的login下，所以不用跨控制器。</p>
<p>这样，我们就完成了不同用户访问不同界面的功能。</p>
]]></content>
      <categories>
        <category>数据库课程设计</category>
      </categories>
  </entry>
  <entry>
    <title>数据库课程设计学习记录六(完)</title>
    <url>/2020/05/30/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E5%85%AD-%E5%AE%8C/</url>
    <content><![CDATA[<h3 id="完善细节"><a href="#完善细节" class="headerlink" title="完善细节"></a>完善细节</h3><p>其实很早就完成了，但不是很想写笔记¯_(ツ)_/¯</p>
<a id="more"></a>

<h5 id="增加用户权限控制"><a href="#增加用户权限控制" class="headerlink" title="增加用户权限控制"></a>增加用户权限控制</h5><p>增加用户权限控制的方法很简单，所有继承自Base控制器的控制器在执行前都必须执行Base，所以我们写多个不同的Base，对应不同的表，在Base中进行用户类别的判断，如果他是可以访问这个表的用户，即通过，如果不行，则直接弹出权限错误。（这里有个小改动，将超级管理员的用户类别从0改为4，因为0一般用来判断是否登录）</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_initialize</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!session(<span class="string">'yonghuleibie'</span>))&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;error(<span class="string">'请先登录系统！'</span>,<span class="string">'Login/login'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(session(<span class="string">'yonghuleibie'</span>) != <span class="number">3</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(session(<span class="string">'yonghuleibie'</span>) != <span class="number">4</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;error(<span class="string">'您的权限无法访问此表！'</span>);&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码很好理解，凡事继承自他的控制器首先要执行这段代码，意为如果没有用户类别，说明没有登录，会弹出没有登录的错误，如果是用户管理员(1)或者维修员(2)，他们是没有权限访问这张表的，所以会弹出权限不足错误。</p>
<p>与此同时，在普通用户的控制器下，应该继承这个类：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">controller</span>\<span class="title">Base</span>;</span><br><span class="line">......</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Search</span> <span class="keyword">extends</span> <span class="title">Base</span></span></span><br></pre></td></tr></table></figure>
<p>这样重复几遍，就能实现每种用户的分离操作，即使用户知道其他类型用户的数据表的路由，他依然无法访问。</p>
<h5 id="退出登录"><a href="#退出登录" class="headerlink" title="退出登录"></a>退出登录</h5><p>退出登录的方法十分简单，只需要把退出登录的按钮连接到login界面，然后在执行返回login模版前将session置0即可。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    session(<span class="string">'yonghuleibie'</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;fetch();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>就像这样，虽然用拼音真的很蠢，但是在这么多字段的情况下用拼音比较好分辨¯_(ツ)_/¯。</p>
<p>这样每次进入login界面都会直接退出登录状态。</p>
<h3 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h3><p>自此，在稍微调整下细微的差错，加上自己喜欢的CSS样式，这个鸡肋的实验室设备管理系统就做好了，因为课设时间有些紧张，而且还有其他的课程考试，好多想法因为怕出错都没有实验，只做出了最简单的题目所要求的功能，而且没有打磨细节，虽然如此，仍然可以感觉到thinkphp是一款比较优秀的框架，以后一定会深入的学习它。</p>
<p>终于完了，泪目(T^T)。最后放张E-R图来结束这个学习记录(不过好像E-R图要一开始画好耶)</p>
<p><img src="/2020/05/30/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E5%85%AD-%E5%AE%8C/ER.png" alt="E-R图"></p>
<p>在放上课设报告和模块源码：</p>
<p><a href="/download/课设报告.docx">课设报告</a></p>
<p><a href="/download/课设源码.zip">课设源码</a></p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://www.bilibili.com/video/BV1Vx411V7fE" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Vx411V7fE</a> 千锋教育ThinkPHP5.0框架全方位解读与实战</p>
<p><a href="https://www.bilibili.com/video/BV17J411K7Zd" target="_blank" rel="noopener">https://www.bilibili.com/video/BV17J411K7Zd</a> 李炎恢ThinkPHP5.1PHP框架十天精品课堂</p>
<p><a href="https://www.freedgo.com/erd-index.html" target="_blank" rel="noopener">https://www.freedgo.com/erd-index.html</a> E-R图在线绘制</p>
<p>thinkphp5.0官方文档</p>
]]></content>
      <categories>
        <category>数据库课程设计</category>
      </categories>
  </entry>
  <entry>
    <title>数据库课程设计学习记录四</title>
    <url>/2020/05/23/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E5%9B%9B/</url>
    <content><![CDATA[<h3 id="实现登录验证"><a href="#实现登录验证" class="headerlink" title="实现登录验证"></a>实现登录验证</h3><p>我们按照跳转的方式，将登录的用户直接跳转到主界面，即可实现登录功能，但是如果有人没有登录，但是他知道我们主界面的路由，他也一样可以进入主界面，所以我们通过登录验证的方法来限制这样的访问。</p>
<a id="more"></a>

<h5 id="建立用户登录界面"><a href="#建立用户登录界面" class="headerlink" title="建立用户登录界面"></a>建立用户登录界面</h5><p>首先我们按照以前的方式建立用户表，用户信息录入界面，然后我们建立一个叫做Login.php的控制器，在控制器里写入：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">model</span>\<span class="title">Yonghu</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Login</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;fetch();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这一段很好理解，我们再去建立一个model文件就好了。接下来我们就是需要去写login.html文件。</p>
<p>在view下我们建立一个login文件夹，里面建立login.html文件，在html文件里写入：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-cn"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"renderer"</span> <span class="attr">content</span>=<span class="string">"webkit"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">title</span>&gt;</span>  </span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/jquery.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/pintuer.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bg"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"line bouncein"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"xs6 xm4 xs3-move xm4-move"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"height:150px;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"media media-y margin-big-bottom"</span>&gt;</span>           </span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span>         </span><br><span class="line">            <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"check"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel loginbox"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"text-center margin-big padding-big-top"</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span>后台管理中心<span class="tag">&lt;/<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span> <span class="attr">style</span>=<span class="string">"padding:30px; padding-bottom:10px; padding-top:10px;"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field field-icon-right"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input input-big"</span> <span class="attr">name</span>=<span class="string">"yonghuhao"</span> <span class="attr">placeholder</span>=<span class="string">"用户号"</span> <span class="attr">data-validate</span>=<span class="string">"required:请填写账号"</span> /&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon icon-user margin-small"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field field-icon-right"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">class</span>=<span class="string">"input input-big"</span> <span class="attr">name</span>=<span class="string">"mima"</span> <span class="attr">placeholder</span>=<span class="string">"密码"</span> <span class="attr">data-validate</span>=<span class="string">"required:请填写密码"</span> /&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"icon icon-key margin-small"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"field"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"input input-big"</span> <span class="attr">name</span>=<span class="string">"code"</span> <span class="attr">placeholder</span>=<span class="string">"填写右侧的验证码"</span> <span class="attr">data-validate</span>=<span class="string">"required:请填写右侧的验证码"</span> /&gt;</span></span><br><span class="line">                           <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;:captcha_src()&#125;"</span> <span class="attr">alt</span>=<span class="string">"capcha"</span>  <span class="attr">class</span>=<span class="string">"passcode"</span> <span class="attr">style</span>=<span class="string">"height:43px;cursor:pointer;"</span> <span class="attr">onclick</span>=<span class="string">"this.src=this.src+'?'"</span>&gt;</span>  </span><br><span class="line">                                                   </span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"padding:30px;"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"button button-block bg-main text-big input-big"</span> <span class="attr">value</span>=<span class="string">"登录"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span>          </span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里面包括了用户号，密码和验证码</p>
<h5 id="验证用户是否正确"><a href="#验证用户是否正确" class="headerlink" title="验证用户是否正确"></a>验证用户是否正确</h5><p>然后我们回去在控制器里写入一个方法：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span><span class="params">()</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       $data = input(<span class="string">'post.'</span>);</span><br><span class="line">       $user = <span class="keyword">new</span> Yonghu();</span><br><span class="line">       $result = $user-&gt;where(<span class="string">'yonghuhao'</span>,$data[<span class="string">'yonghuhao'</span>])-&gt;find();</span><br><span class="line">       <span class="keyword">if</span>($result)&#123;</span><br><span class="line">           <span class="keyword">if</span>($result[<span class="string">'mima'</span>] === $data[<span class="string">'mima'</span>])&#123;</span><br><span class="line">               session(<span class="string">'yonghuhao'</span>,$data[<span class="string">'yonghuhao'</span>]);</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">else</span>&#123;</span><br><span class="line">               <span class="keyword">$this</span>-&gt;error(<span class="string">'密码不正确'</span>);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">$this</span>-&gt;error(<span class="string">'用户名不存在'</span>);</span><br><span class="line">           <span class="keyword">exit</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span>(captcha_check($data[<span class="string">'code'</span>]))&#123;</span><br><span class="line">           <span class="keyword">$this</span>-&gt;success(<span class="string">'登录成功！'</span>,<span class="string">'login/index'</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">$this</span>-&gt;error(<span class="string">'验证码不正确'</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>这段代码即验证我们输入的内容是否和数据库里的用户表信息相匹配。<br>其中有个session方法，这就是我们一会验证有无登录时做到。</p>
<p>我们输入一个正确的用户号和密码，点击登录，他就会提示登录成功：</p>
<p><img src="/2020/05/23/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E5%9B%9B/%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F.png" alt="登录成功"></p>
<p>然后跳转到主界面：（主界面还未完善，中间的报错可以无视(´▽｀)）</p>
<p><img src="/2020/05/23/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E5%9B%9B/%E4%B8%BB%E7%95%8C%E9%9D%A2.png" alt="主界面"></p>
<h5 id="验证是否登录"><a href="#验证是否登录" class="headerlink" title="验证是否登录"></a>验证是否登录</h5><p>但是现在我们直接输入主界面的路由，不用登录我们也能访问，所以我们要设置验证：</p>
<p>我们在新创建一个控制器base.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_initialize</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!session(<span class="string">'yonghuhao'</span>))&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;error(<span class="string">'请先登录系统！'</span>,<span class="string">'Login/login'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后将我们的主界面上面更改为：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">controller</span>\<span class="title">Base</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">model</span>\<span class="title">Yonghu</span> <span class="title">as</span> <span class="title">UserModel</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">keshe</span>\<span class="title">validate</span>\<span class="title">Valyong</span> <span class="title">as</span> <span class="title">UserValidate</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Yonghu</span> <span class="keyword">extends</span> <span class="title">Base</span></span></span><br></pre></td></tr></table></figure>
<p>这样，在执行主界面方法时，我们就会先去执行base.php, 在base.php里我们要验证session参数，当有这个参数，即为登录过后，我们才能访问主界面，否则，会提示请先登录，然后跳转到登录界面：</p>
<p><img src="/2020/05/23/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%E5%9B%9B/%E8%AF%B7%E5%85%88%E7%99%BB%E5%BD%95.png" alt="请先登录.png"></p>
]]></content>
      <categories>
        <category>数据库课程设计</category>
      </categories>
  </entry>
  <entry>
    <title>模拟文件系统程序</title>
    <url>/2020/06/13/%E6%A8%A1%E6%8B%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F/</url>
    <content><![CDATA[<h3 id="模拟文件系统程序"><a href="#模拟文件系统程序" class="headerlink" title="模拟文件系统程序"></a>模拟文件系统程序</h3><p>题目即为用C++模拟五个常用的DOS命令，create，MD，DIR，CD，DIRALL</p>
<a id="more"></a>

<p>详细题目：</p>
<p>模拟文件系统中的树型目录结构，并模拟实现常用Dos命令。如：Dir, Md, Cd, Rd, create filename等<br>1.创建目录结构。操作：选择一种树的存储结构，创建一个树。默认情况下，只含有一个根结点“#”。<br>模Create命令，创建新文件，添加到当前目录中。<br> 格式：create filename filesize。操作：将文件作为结点加入到树中。<br>模拟MD命令，创建子目录，添加到当前目录中。<br> 格式：MD directoryname。操作：将目录作为结点加入到树中。<br>模拟CD命令，进行父子目录见的切换。<br> 格式：CD directoryname。操作：将当前状态改为dirctoryname目录。<br>模拟Dir命令，列出当前目录下的所有子目录名和文件名。<br>格式：Dir 。操作：遍历树结构，列出树结构中当前结点的孩子结点，并列出结点的性质（文件名，目录名）<br>模拟dir/all。列出当前目录下所有子目录和文件名。<br>其它：RD,CD,CD..,else提示：“Bad command”;<br>其它要求：在使用常用命令的过程中，不区分大小写。<br>提示：主程序用死循环，当用户敲入exit时，break,结束程序。</p>
<p>这个结构可以用树来简单模拟，但是树有多少个子节点是确定的，文件夹里有多少项目却是不确定的，所以我们可以使用子节点非常多的树结构去实现，这样是比较方便的，虽然子节点很多，但都是没有分配空间的指针，所以不会造成空间浪费。</p>
<h5 id="树的结构"><a href="#树的结构" class="headerlink" title="树的结构"></a>树的结构</h5><p>这里以五个子节点为例（即一个文件夹下最多放五个项目）：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BiNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> type;</span><br><span class="line">    <span class="built_in">string</span> name;</span><br><span class="line">    BiNode *onechild, *twochild, *threechild, *fourchild, *fivechild;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> BiNode *BiTree;</span><br></pre></td></tr></table></figure>

<p>首先我们要将其初始化：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(BiTree &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T = <span class="keyword">new</span> BiNode;</span><br><span class="line">    T-&gt;onechild = <span class="literal">nullptr</span>;</span><br><span class="line">    T-&gt;twochild = <span class="literal">nullptr</span>;</span><br><span class="line">    T-&gt;threechild = <span class="literal">nullptr</span>;</span><br><span class="line">    T-&gt;fourchild = <span class="literal">nullptr</span>;</span><br><span class="line">    T-&gt;fivechild = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="create函数"><a href="#create函数" class="headerlink" title="create函数"></a>create函数</h5><p>然后我们可以开始写create函数了，在这个结构里，因为我们只是展示下结构，没必要深究文件的结构，所以文件的结构和文件夹的数据结构是一致的，为了区分目录和文件的区别，我们节点里有一项type，当type为1时，说明是文件，是2时，说明是文件夹。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">(<span class="built_in">string</span> name, BiTree &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BiNode *a;</span><br><span class="line">    a = <span class="keyword">new</span> BiNode;</span><br><span class="line">    a-&gt;name = name;</span><br><span class="line">    a-&gt;type = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(!T-&gt;onechild)</span><br><span class="line">    &#123;</span><br><span class="line">        T-&gt;onechild = a;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">       <span class="keyword">if</span>(!T-&gt;twochild)</span><br><span class="line">       &#123;</span><br><span class="line">           T-&gt;twochild = a;</span><br><span class="line">           <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">if</span>(!T-&gt;threechild)</span><br><span class="line">           &#123;</span><br><span class="line">               T-&gt;threechild = a;</span><br><span class="line">               <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">           &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">               <span class="keyword">if</span>(!T-&gt;fourchild)</span><br><span class="line">               &#123;</span><br><span class="line">                   T-&gt;fourchild = a;</span><br><span class="line">                   <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">               &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                   <span class="keyword">if</span>(!T-&gt;fivechild)</span><br><span class="line">                   &#123;</span><br><span class="line">                       T-&gt;fivechild = a;</span><br><span class="line">                       <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                       <span class="built_in">cout</span> &lt;&lt; <span class="string">"该文件夹已满！"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然MD操作和create是基本一致的：</p>
<h5 id="MD函数"><a href="#MD函数" class="headerlink" title="MD函数"></a>MD函数</h5><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MD</span><span class="params">(<span class="built_in">string</span> name, BiTree &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BiNode *a;</span><br><span class="line">    a = <span class="keyword">new</span> BiNode;</span><br><span class="line">    a-&gt;name = name;</span><br><span class="line">    a-&gt;type = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(!T-&gt;onechild)</span><br><span class="line">    &#123;</span><br><span class="line">        T-&gt;onechild = a;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件夹成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!T-&gt;twochild)</span><br><span class="line">        &#123;</span><br><span class="line">            T-&gt;twochild = a;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件夹成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(!T-&gt;threechild)</span><br><span class="line">            &#123;</span><br><span class="line">                T-&gt;threechild = a;</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件夹成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(!T-&gt;fourchild)</span><br><span class="line">                &#123;</span><br><span class="line">                    T-&gt;fourchild = a;</span><br><span class="line">                    <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件夹成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(!T-&gt;fivechild)</span><br><span class="line">                    &#123;</span><br><span class="line">                        T-&gt;fivechild = a;</span><br><span class="line">                        <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件夹成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="built_in">cout</span> &lt;&lt; <span class="string">"该文件夹已满！"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="DIR函数"><a href="#DIR函数" class="headerlink" title="DIR函数"></a>DIR函数</h5><p>接下来写DIR，DIR十分简单，只要把这个目录下的节点全部打印出来就好：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">DIR</span><span class="params">(BiTree &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;onechild)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; T-&gt;onechild-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;twochild)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; T-&gt;twochild-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;threechild)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; T-&gt;threechild-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;fourchild)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; T-&gt;fourchild-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;fivechild)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; T-&gt;fivechild-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="CD函数"><a href="#CD函数" class="headerlink" title="CD函数"></a>CD函数</h5><p>接下来是最难的CD，这里的CD只实现了最基本的功能，cd至子节点，或者cd至根，至于连跳这些，只需要对字符串处理分割就好了，这里不实现了。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">BiTree <span class="title">CD</span><span class="params">(BiTree &amp;T, <span class="built_in">string</span> dirname, BiNode *first)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(dirname == <span class="string">"/"</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> first;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;onechild-&gt;name == dirname <span class="keyword">and</span> T-&gt;onechild-&gt;type == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T-&gt;onechild;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;twochild-&gt;name == dirname <span class="keyword">and</span> T-&gt;twochild-&gt;type == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T-&gt;twochild;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;threechild-&gt;name == dirname <span class="keyword">and</span> T-&gt;threechild-&gt;type == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T-&gt;threechild;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;fourchild-&gt;name == dirname <span class="keyword">and</span> T-&gt;fourchild-&gt;type == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T-&gt;fourchild;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;fivechild-&gt;name == dirname <span class="keyword">and</span> T-&gt;fivechild-&gt;type == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T-&gt;fivechild;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"No such file or directory"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里的first是主函数里记录了T开头的一个指针：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">BiTree T;</span><br><span class="line">    init(T);</span><br><span class="line">    BiNode *first = T;</span><br></pre></td></tr></table></figure>

<h5 id="DIRALL函数"><a href="#DIRALL函数" class="headerlink" title="DIRALL函数"></a>DIRALL函数</h5><p>接下来是dirall，这就是简单的深度遍历了：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">PreTraverse</span><span class="params">(BiTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (T == <span class="literal">nullptr</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; T-&gt;name;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    PreTraverse(T-&gt;onechild);</span><br><span class="line">    PreTraverse(T-&gt;twochild);</span><br><span class="line">    PreTraverse(T-&gt;threechild);</span><br><span class="line">    PreTraverse(T-&gt;fourchild);</span><br><span class="line">    PreTraverse(T-&gt;fivechild);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="主函数"><a href="#主函数" class="headerlink" title="主函数"></a>主函数</h5><p>接下来是主函数，主函数是一个死循环，当输入exit时退出并结束：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BiTree T;</span><br><span class="line">    init(T);</span><br><span class="line">    BiNode *first = T;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> cmd;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; cmd;</span><br><span class="line">        <span class="keyword">if</span>(cmd == <span class="string">"create"</span> <span class="keyword">or</span> cmd == <span class="string">"CREATE"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> name;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; name;</span><br><span class="line">            create(name, T);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cmd == <span class="string">"MD"</span> <span class="keyword">or</span> cmd == <span class="string">"md"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> name;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; name;</span><br><span class="line">            MD(name, T);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cmd == <span class="string">"DIR"</span> <span class="keyword">or</span> cmd == <span class="string">"dir"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            DIR(T);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cmd == <span class="string">"cd"</span> <span class="keyword">or</span> cmd == <span class="string">"CD"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> dirname;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; dirname;</span><br><span class="line">            T = CD(T, dirname, first);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cmd == <span class="string">"dirall"</span> <span class="keyword">or</span> cmd == <span class="string">"DIRALL"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            PreTraverse(T);</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cmd == <span class="string">"exit"</span> <span class="keyword">or</span> cmd == <span class="string">"EXIT"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"see you again!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="演示和全部代码"><a href="#演示和全部代码" class="headerlink" title="演示和全部代码"></a>演示和全部代码</h5><p>接下来是演示当图片：</p>
<p><img src="/2020/06/13/%E6%A8%A1%E6%8B%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F/%E6%BC%94%E7%A4%BA%E7%BB%93%E6%9E%9C.png" alt="演示结果"></p>
<p>最后附上全部代码：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BiNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> type;</span><br><span class="line">    <span class="built_in">string</span> name;</span><br><span class="line">    BiNode *onechild, *twochild, *threechild, *fourchild, *fivechild;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> BiNode *BiTree;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(BiTree &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T = <span class="keyword">new</span> BiNode;</span><br><span class="line">    T-&gt;onechild = <span class="literal">nullptr</span>;</span><br><span class="line">    T-&gt;twochild = <span class="literal">nullptr</span>;</span><br><span class="line">    T-&gt;threechild = <span class="literal">nullptr</span>;</span><br><span class="line">    T-&gt;fourchild = <span class="literal">nullptr</span>;</span><br><span class="line">    T-&gt;fivechild = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">(<span class="built_in">string</span> name, BiTree &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BiNode *a;</span><br><span class="line">    a = <span class="keyword">new</span> BiNode;</span><br><span class="line">    a-&gt;name = name;</span><br><span class="line">    a-&gt;type = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(!T-&gt;onechild)</span><br><span class="line">    &#123;</span><br><span class="line">        T-&gt;onechild = a;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">       <span class="keyword">if</span>(!T-&gt;twochild)</span><br><span class="line">       &#123;</span><br><span class="line">           T-&gt;twochild = a;</span><br><span class="line">           <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">           <span class="keyword">if</span>(!T-&gt;threechild)</span><br><span class="line">           &#123;</span><br><span class="line">               T-&gt;threechild = a;</span><br><span class="line">               <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">           &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">               <span class="keyword">if</span>(!T-&gt;fourchild)</span><br><span class="line">               &#123;</span><br><span class="line">                   T-&gt;fourchild = a;</span><br><span class="line">                   <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">               &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                   <span class="keyword">if</span>(!T-&gt;fivechild)</span><br><span class="line">                   &#123;</span><br><span class="line">                       T-&gt;fivechild = a;</span><br><span class="line">                       <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                       <span class="built_in">cout</span> &lt;&lt; <span class="string">"该文件夹已满！"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MD</span><span class="params">(<span class="built_in">string</span> name, BiTree &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BiNode *a;</span><br><span class="line">    a = <span class="keyword">new</span> BiNode;</span><br><span class="line">    a-&gt;name = name;</span><br><span class="line">    a-&gt;type = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(!T-&gt;onechild)</span><br><span class="line">    &#123;</span><br><span class="line">        T-&gt;onechild = a;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件夹成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!T-&gt;twochild)</span><br><span class="line">        &#123;</span><br><span class="line">            T-&gt;twochild = a;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件夹成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(!T-&gt;threechild)</span><br><span class="line">            &#123;</span><br><span class="line">                T-&gt;threechild = a;</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件夹成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(!T-&gt;fourchild)</span><br><span class="line">                &#123;</span><br><span class="line">                    T-&gt;fourchild = a;</span><br><span class="line">                    <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件夹成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(!T-&gt;fivechild)</span><br><span class="line">                    &#123;</span><br><span class="line">                        T-&gt;fivechild = a;</span><br><span class="line">                        <span class="built_in">cout</span> &lt;&lt; <span class="string">"创建"</span> &lt;&lt; name &lt;&lt; <span class="string">"文件夹成功!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="built_in">cout</span> &lt;&lt; <span class="string">"该文件夹已满！"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">PreTraverse</span><span class="params">(BiTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (T == <span class="literal">nullptr</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; T-&gt;name;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    PreTraverse(T-&gt;onechild);</span><br><span class="line">    PreTraverse(T-&gt;twochild);</span><br><span class="line">    PreTraverse(T-&gt;threechild);</span><br><span class="line">    PreTraverse(T-&gt;fourchild);</span><br><span class="line">    PreTraverse(T-&gt;fivechild);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">DIR</span><span class="params">(BiTree &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;onechild)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; T-&gt;onechild-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;twochild)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; T-&gt;twochild-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;threechild)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; T-&gt;threechild-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;fourchild)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; T-&gt;fourchild-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;fivechild)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; T-&gt;fivechild-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">BiTree <span class="title">CD</span><span class="params">(BiTree &amp;T, <span class="built_in">string</span> dirname, BiNode *first)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(dirname == <span class="string">"/"</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> first;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;onechild-&gt;name == dirname <span class="keyword">and</span> T-&gt;onechild-&gt;type == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T-&gt;onechild;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;twochild-&gt;name == dirname <span class="keyword">and</span> T-&gt;twochild-&gt;type == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T-&gt;twochild;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;threechild-&gt;name == dirname <span class="keyword">and</span> T-&gt;threechild-&gt;type == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T-&gt;threechild;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;fourchild-&gt;name == dirname <span class="keyword">and</span> T-&gt;fourchild-&gt;type == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T-&gt;fourchild;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;fivechild-&gt;name == dirname <span class="keyword">and</span> T-&gt;fivechild-&gt;type == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T-&gt;fivechild;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"No such file or directory"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BiTree T;</span><br><span class="line">    init(T);</span><br><span class="line">    BiNode *first = T;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> cmd;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; cmd;</span><br><span class="line">        <span class="keyword">if</span>(cmd == <span class="string">"create"</span> <span class="keyword">or</span> cmd == <span class="string">"CREATE"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> name;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; name;</span><br><span class="line">            create(name, T);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cmd == <span class="string">"MD"</span> <span class="keyword">or</span> cmd == <span class="string">"md"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> name;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; name;</span><br><span class="line">            MD(name, T);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cmd == <span class="string">"DIR"</span> <span class="keyword">or</span> cmd == <span class="string">"dir"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            DIR(T);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cmd == <span class="string">"cd"</span> <span class="keyword">or</span> cmd == <span class="string">"CD"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> dirname;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; dirname;</span><br><span class="line">            T = CD(T, dirname, first);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cmd == <span class="string">"dirall"</span> <span class="keyword">or</span> cmd == <span class="string">"DIRALL"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            PreTraverse(T);</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(cmd == <span class="string">"exit"</span> <span class="keyword">or</span> cmd == <span class="string">"EXIT"</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">"see you again!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>完</p>
]]></content>
      <categories>
        <category>homework</category>
      </categories>
  </entry>
  <entry>
    <title>正则表达式入门一</title>
    <url>/2020/04/29/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h3 id="首先，正则表达式是用来描述符合某些复杂规则的字符串"><a href="#首先，正则表达式是用来描述符合某些复杂规则的字符串" class="headerlink" title="首先，正则表达式是用来描述符合某些复杂规则的字符串"></a>首先，正则表达式是用来描述符合某些复杂规则的字符串</h3><p>本文主要是给自己做的笔记，其中大量参考了<a href="https://deerchao.cn/tutorials/regex/regex.htm的内容。" target="_blank" rel="noopener">https://deerchao.cn/tutorials/regex/regex.htm的内容。</a></p>
<a id="more"></a>
<h3 id="了解"><a href="#了解" class="headerlink" title="了解"></a>了解</h3><p>首先先展示一些代码的功能：<br>. 表示任何单个字符<br>[ ] 字符集，对单个字符给出取值范围  [abc]表示a、b、c,<br>[^] 对单个字符给出排除范围 [^abc]表示非abc的单个字符<br>* 前一个字符0次或无限次扩展<br>+ 前一个字符一次或无限次扩展<br>？ 前一个字符0次或1次扩展<br>｜ 左右表达式任意一个 abc|def 表示abc、def<br>{m} 扩展前一个字符m次 ab{2}c表示abbc<br>{m, n} 扩展前一个字符m至n次 ab{1,2}c表示abc、abbc<br>^ 匹配字符的开头 ^abc表示abc且在一个字符串的开头<br>$ 匹配字符串开头 abc$表示abc且在一个字符的结尾<br>( ) 分组标记，内部只能使用｜操作符 (abc)表示abc，(abc|def)表示abc、def<br>\d 数字，等价于[0-9]<br>\w 单词字符，等价于[A-Za-z0-9_]<br>\b 匹配单词的开始或结束</p>
<p>这些代码的组合就可以匹配各种复杂的字符串</p>
<p>我们先来看几个经典的正则表达式：<br>^[A-Za-z]+$ 由26个字母组成的字符串<br>^-?\d+$ 整数形式的字符串<br>^[0-9]*[1-9][0-9]*$ 正整数形式的字符串<br>[1-9]\d{5} 中国境内邮政编码，6位<br>[\u4e00-\u9fa5] 匹配中文字符</p>
<p>这几个我们可以等会在返回来看，我们先从简单的开始</p>
<h3 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h3><h5 id="匹配简单字符"><a href="#匹配简单字符" class="headerlink" title="匹配简单字符"></a>匹配简单字符</h5><p>hi 可以匹配hi这个字符，只要是含有hi便可以匹配，如hi，him里的hi</p>
<p>那如何匹配一个单词呢？</p>
<p>首先我们先介绍一下”单词“的概念，这和我们通常理解的有些许不同：</p>
<p>\w可以匹配任何一个字母或数字或中文或下划线，注意是一个<br>然后，不少于1个\w连起来中间没有其他的东西即为单词<br>比如 abc, a_3 都是单词</p>
<p>那我们要匹配hi这个单词的话，就可以使用 \bhi\b</p>
<h5 id="匹配数字"><a href="#匹配数字" class="headerlink" title="匹配数字"></a>匹配数字</h5><p>如果我们想匹配一组类似于010-12345678这样的电话号码的话<br>我们要用到的代码有</p>
<p>\d 表示一个数字<br>{m} 扩展前一个字符m次</p>
<p>现在，我们写出这样的表达式：<br>0/d{2}-/d{8}</p>
<p>0表示匹配0，所有的电话号码开头都是0，然后后面匹配两位数字，然后匹配中横线，<br>最后再匹配8位数字</p>
<p>如果我们既想匹配上面的电话号，又想匹配正常的手机号码(如18012345678)，那么<br>就需要用到分支条件，代码为｜</p>
<p>首先我们看了解部分里的代码</p>
<p>｜ 左右表达式任意一个 abc|def 表示abc、def</p>
<p>这样就很清晰明了了，代码如下</p>
<p>0/d{2}-/d{8}|1/d{2}/d{8}</p>
<p>这样就能匹配到两种不同格式的电话号码了</p>
<p>如果我们想要匹配多组重复的数据的话，我们就需要()来建立一个子表达式，然后可以对<br>这个表达式进行相关的操作，如表示IP地址，IP地址是由4个不大于255的数字加.组成的<br>如：<br>0.0.0.0<br>10.0.0.1<br>127.0.0.1<br>192.168.1.1<br>255.255.255.255<br>都是合法的IP地址，我们先用一组正则表达式表达四个数字中的一个：<br>这个数字有几种情况：[01]?\d\d?、2[0-4]\d、25[0-5],分别代表了0-199、200-249、<br>250-255这几个区间，我们用｜把他们连接起来，就构成了表达0-255的表达式，现在在用<br>()把这组数字变成一个子表达式，然后再重复四次，IP地址的表达式就完成了。</p>
<p>（[01]?\d\d?|2[0-4]\d|25[0-5].){3}([01]?\d\d?|2[0-4]\d|25[0-5])</p>
<p>值得注意的是.这个符号只出现了三次，所以最后的地址是不带.的</p>
<h5 id="反义代码"><a href="#反义代码" class="headerlink" title="反义代码"></a>反义代码</h5><p>反义的代码就是反过来，如\w匹配任何字母数字汉字，那\W就是匹配除了字母数字汉字以外的字符</p>
<p>反义代码有以下几个:</p>
<p>\W   匹配任意不是字母，数字，下划线，汉字的字符<br>\S   匹配任意不是空白符的字符<br>\D   匹配任意非数字的字符<br>\B   匹配不是单词开头或结束的位置<br>[^x] 匹配除了x以外的任意字符</p>
<h5 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h5><p>在开头提到的那篇文章里，这部分的用法叫后向引用，但是这个名字有点晦涩难懂，所以我习惯叫分组</p>
<p>使用小括号的子表达式，都会有一个默认的分组编号，通过这个编号我们可以重复的搜索前面分组匹配过的文本，下面举个例子：</p>
<p>首先我们匹配一个普通的单词：<br>\b(\w+)\b<br>这个正则表达式的意思是匹配一个单词，前后\b是单词的开头和结束，中间是\w匹配一次或多次扩展，这个单词会被标记为分组一(如果前面没有过这样的分组的话)，然后我们可以直接引用\1这个代码表示这个分组，如：</p>
<p>\b(\w+)\b \1 这样的表达式意思是匹配一组相同的单词，中间用空格分隔,注意这样的写法,如果文本是yi yie这样的，他也会匹配出yi yi，但是如果正则表达式为\b(\w+)\b \1\b，就不会匹配出这样的结果，因为yie才是一个单词</p>
<p>我们还可以指定分组的组名，使用的语法是(?<name>exp),也可以把尖括号改为单引号：</name></p>
<p>\b(?<fenzu>\w+)\b \k<fenzu>\b</fenzu></fenzu></p>
<p>引用自己命名的分组是\k&lt;组名&gt;，引用的结果和上面一样</p>
<p>还有一种代码，格式为(?:exp)，这种格式会不分配组号，也不捕获文本，只是会单纯的匹配文本</p>
<h3 id="第一章完～"><a href="#第一章完～" class="headerlink" title="第一章完～"></a>第一章完～</h3>]]></content>
      <categories>
        <category>python</category>
      </categories>
  </entry>
  <entry>
    <title>正则表达式入门二</title>
    <url>/2020/05/03/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%85%A5%E9%97%A8%E4%BA%8C/</url>
    <content><![CDATA[<h3 id="零宽断言"><a href="#零宽断言" class="headerlink" title="零宽断言"></a>零宽断言</h3><p>零宽断言这四个字还是有些难以理解，所以还是直接上例子，直观又清晰。</p>
<a id="more"></a>

<h5 id="零宽断言-1"><a href="#零宽断言-1" class="headerlink" title="零宽断言"></a>零宽断言</h5><p>但这一个名字我并没有理解这是什么东西，直到我看完了例子，下面直接给出例子：</p>
<p>(?=exp) 匹配后面为exp的内容，即 XXXexp,匹配XXX</p>
<p>例如 \b\w+(?=ing\b) 这个正则表达式，前面\b\w+的意思是首先匹配单词的开头，然后是连续的单词字符，到了后面括号里的，他就规定了前面这些东西必须满足后面是ing并且ing后是单词结束才能匹配，singing就会匹配出sing,如果是\b\w+(?=ing)会怎么样呢？实际上还是sing，为什么不是s？，马上就会在贪心和非贪心中给出答案</p>
<p>(?&lt;=exp) 匹配前面为exp的内容，即 expXXX,匹配XXX</p>
<p>例如(?&lt;=\bsi)\w+\b 这个正则表达式，会匹配以si开头的单词的除了si以外的部分，如singing，会匹配到inging。</p>
<h5 id="负向零宽断言"><a href="#负向零宽断言" class="headerlink" title="负向零宽断言"></a>负向零宽断言</h5><p>仍然是直接看例子：</p>
<p>(?!exp) 匹配后面不是exp的内容，即 XXXexp，不匹配XXX</p>
<p>\d(?!\d) 匹配一位数字，而且他的后面不是数字，比如123，就只会匹配到3</p>
<p>(?&lt;!exp) 匹配前面不是exp的内容，即 expXXX，不匹配XXX</p>
<p>(?&lt;!\d)\d 匹配一位数字，而且他的前面不是数字，比如123，就只会匹配到1</p>
<h3 id="贪心与非贪心"><a href="#贪心与非贪心" class="headerlink" title="贪心与非贪心"></a>贪心与非贪心</h3><p>也可以叫做贪婪与懒惰，都是一个意思，比如 a\w+d这个正则表达式,现在我们知道他是匹配以a为开头d为结尾并且中间以不少于一个中英文数字字符的单词，但是如果是asdsd这样的字符串，那么他匹配的是asd还是asdsd呢？</p>
<p>答案是asdsd，因为一般默认的都是贪心匹配，他会尽可能的匹配较多的字符。</p>
<p>我们可以将这个正则表达式改为非贪心匹配，只需要在+后加一个?，就可以了</p>
<p>a\w+?d</p>
<p>这样匹配的结果就会匹配尽可能少的字符串，比如asdsd，就会匹配出asd，加的?号是用来限定他前面的代码的，+号是匹配一次或多次，用?号来限定他匹配更少的字符，所以要加在+号后。</p>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>注释是很必要的，正则表达式是一种很复杂的语法，要给别人看或者看自己写了很久的正则表达式都需要费一番功夫，所以加上注释比较容易理解，注释的格式是：</p>
<p>(?#comment) </p>
<p>比如：</p>
<p>[1-9]\d(?#10-99) ，注释就提示了前面的正则表达式所表示的范围为10-99之间的数字。</p>
<h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>正则表达式的内容还有很多很多，这里只是最基础的用法，python中正则表达式库是re库，这个库是标准库，我们只需要import re就可以使用，有关re库的基础用法可以查看下一篇博客。</p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
  </entry>
  <entry>
    <title>生日纪念～</title>
    <url>/2020/05/18/%E7%BA%AA%E5%BF%B5%E4%B8%8B%E8%87%AA%E5%B7%B1%E7%9A%8419%E5%B2%81%EF%BD%9E/</url>
    <content><![CDATA[<h3 id="生日画的贺图……-o"><a href="#生日画的贺图……-o" class="headerlink" title="生日画的贺图……^o^"></a>生日画的贺图……<em>^o^</em></h3><a id="more"></a>

<p><img src="/2020/05/18/%E7%BA%AA%E5%BF%B5%E4%B8%8B%E8%87%AA%E5%B7%B1%E7%9A%8419%E5%B2%81%EF%BD%9E/%E7%94%9F%E6%97%A5%E8%B4%BA%E5%9B%BE.jpg" alt="生日贺图"></p>
<p>第一个阳历农历重合的生日(´▽｀)，许的愿望是将来能成为大触( ̀⌄ ́)</p>
]]></content>
  </entry>
  <entry>
    <title>进程调度模拟程序设计</title>
    <url>/2020/06/13/%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E6%A8%A1%E6%8B%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/</url>
    <content><![CDATA[<h3 id="进程调度模拟程序设计"><a href="#进程调度模拟程序设计" class="headerlink" title="进程调度模拟程序设计"></a>进程调度模拟程序设计</h3><p>题目简单来说，就是模拟按优先数调度算法实现处理器调度的程序，详细题目如下：</p>
<a id="more"></a>

<p><a href="/download/进程调度模拟程序设计.docx">进程调度模拟程序设计题目</a></p>
<p>做这个题目，比较方便的是用链表，而进程可以用如下结构体表示：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PCB</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> name;</span><br><span class="line">    PCB *next;</span><br><span class="line">    <span class="keyword">int</span> time;</span><br><span class="line">    <span class="keyword">int</span> prior;</span><br><span class="line">    <span class="keyword">int</span> status;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>在插入的时候，我们先按照大小查找到要插入的位置，即该节点(进程)的优先级比该位置的要大，就插入到该位置的前面：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">PCBlist::insert</span><span class="params">(PCB p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    PCB *a = <span class="keyword">new</span> PCB;</span><br><span class="line">    a-&gt;name = p.name;</span><br><span class="line">    a-&gt;time = p.time;</span><br><span class="line">    a-&gt;prior = p.prior;</span><br><span class="line">    a-&gt;status = p.status;</span><br><span class="line">    <span class="keyword">if</span>(!head-&gt;next)</span><br><span class="line">    &#123;</span><br><span class="line">        head-&gt;next = a;</span><br><span class="line">        a-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        PCB *b = head-&gt;next;</span><br><span class="line">        PCB *c = head;</span><br><span class="line">        <span class="keyword">for</span>(; b; )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(a-&gt;prior &gt;= b-&gt;prior)</span><br><span class="line">            &#123;</span><br><span class="line">                c-&gt;next = a;</span><br><span class="line">                a-&gt;next = b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            c = c-&gt;next;</span><br><span class="line">            b = b-&gt;next;</span><br><span class="line">            <span class="keyword">if</span>(!b)</span><br><span class="line">            &#123;</span><br><span class="line">                c-&gt;next = a;</span><br><span class="line">                a-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>所以在初始化中，我们就得到了一条完整的按照优先级排列的进程链表，我们只需要每次取出队首的进程，执行(优先级和时间-1)，然后把它从这个链表中拿出，再重新按照优先级插入即可。当运行时间为0时，我们就可以不再重新插入它，而是直接输出状态为E，表示执行完毕：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">run</span><span class="params">(PCBlist &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    PCB *a = T.head;</span><br><span class="line">    PCB *ne;</span><br><span class="line">    a-&gt;next-&gt;time = a-&gt;next-&gt;time - <span class="number">1</span>;</span><br><span class="line">    a-&gt;next-&gt;prior = a-&gt;next-&gt;prior - <span class="number">1</span>;</span><br><span class="line">    ne = a-&gt;next;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"此时正在运行P"</span> &lt;&lt; ne-&gt;name &lt;&lt; <span class="string">"程序"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"程序的运行时间还剩"</span> &lt;&lt; ne-&gt;time &lt;&lt;  <span class="built_in">endl</span>;</span><br><span class="line">    a-&gt;next = ne-&gt;next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(ne-&gt;time)</span><br><span class="line">        T.insert(*ne);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程P"</span> &lt;&lt; ne-&gt;name &lt;&lt; <span class="string">"运行结束"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程名：P"</span> &lt;&lt; ne-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"优先级："</span> &lt;&lt; ne-&gt;prior &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"剩余运行时间："</span> &lt;&lt; ne-&gt;time &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"状态：E"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在每次run，也就是每次执行一个进程时，我们将链表输出，以查看当时的所以未执行完的进程的状态：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">PCBlist::show</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    PCB *a = head-&gt;next;</span><br><span class="line">    <span class="keyword">for</span>(; a; a = a-&gt;next)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程名：P"</span> &lt;&lt; a-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"优先级："</span> &lt;&lt; a-&gt;prior &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"剩余运行时间："</span> &lt;&lt; a-&gt;time &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"状态：R"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span>(T.head-&gt;next)</span><br><span class="line">    &#123;<span class="built_in">run</span>(T);</span><br><span class="line">    T.show();&#125;</span><br></pre></td></tr></table></figure>

<p>下面放上全部的代码和执行结果：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PCB</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> name;</span><br><span class="line">    PCB *next;</span><br><span class="line">    <span class="keyword">int</span> time;</span><br><span class="line">    <span class="keyword">int</span> prior;</span><br><span class="line">    <span class="keyword">int</span> status;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PCBlist</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    PCB *head;</span><br><span class="line">    PCBlist();</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">insert</span><span class="params">(PCB p)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">show</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line">PCBlist::PCBlist()</span><br><span class="line">&#123;</span><br><span class="line">    head = <span class="keyword">new</span> PCB;</span><br><span class="line">    head-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">PCBlist::insert</span><span class="params">(PCB p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    PCB *a = <span class="keyword">new</span> PCB;</span><br><span class="line">    a-&gt;name = p.name;</span><br><span class="line">    a-&gt;time = p.time;</span><br><span class="line">    a-&gt;prior = p.prior;</span><br><span class="line">    a-&gt;status = p.status;</span><br><span class="line">    <span class="keyword">if</span>(!head-&gt;next)</span><br><span class="line">    &#123;</span><br><span class="line">        head-&gt;next = a;</span><br><span class="line">        a-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        PCB *b = head-&gt;next;</span><br><span class="line">        PCB *c = head;</span><br><span class="line">        <span class="keyword">for</span>(; b; )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(a-&gt;prior &gt;= b-&gt;prior)</span><br><span class="line">            &#123;</span><br><span class="line">                c-&gt;next = a;</span><br><span class="line">                a-&gt;next = b;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            c = c-&gt;next;</span><br><span class="line">            b = b-&gt;next;</span><br><span class="line">            <span class="keyword">if</span>(!b)</span><br><span class="line">            &#123;</span><br><span class="line">                c-&gt;next = a;</span><br><span class="line">                a-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">run</span><span class="params">(PCBlist &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    PCB *a = T.head;</span><br><span class="line">    PCB *ne;</span><br><span class="line">    a-&gt;next-&gt;time = a-&gt;next-&gt;time - <span class="number">1</span>;</span><br><span class="line">    a-&gt;next-&gt;prior = a-&gt;next-&gt;prior - <span class="number">1</span>;</span><br><span class="line">    ne = a-&gt;next;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"此时正在运行P"</span> &lt;&lt; ne-&gt;name &lt;&lt; <span class="string">"程序"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"程序的运行时间还剩"</span> &lt;&lt; ne-&gt;time &lt;&lt;  <span class="built_in">endl</span>;</span><br><span class="line">    a-&gt;next = ne-&gt;next;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(ne-&gt;time)</span><br><span class="line">        T.insert(*ne);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程P"</span> &lt;&lt; ne-&gt;name &lt;&lt; <span class="string">"运行结束"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程名：P"</span> &lt;&lt; ne-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"优先级："</span> &lt;&lt; ne-&gt;prior &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"剩余运行时间："</span> &lt;&lt; ne-&gt;time &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"状态：E"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">PCBlist::show</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    PCB *a = head-&gt;next;</span><br><span class="line">    <span class="keyword">for</span>(; a; a = a-&gt;next)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"进程名：P"</span> &lt;&lt; a-&gt;name &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"优先级："</span> &lt;&lt; a-&gt;prior &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"剩余运行时间："</span> &lt;&lt; a-&gt;time &lt;&lt; <span class="string">' '</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"状态：R"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    PCBlist T;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">1</span>;</span><br><span class="line">    PCB a;</span><br><span class="line">    <span class="keyword">int</span> time;</span><br><span class="line">    <span class="keyword">int</span> prior;</span><br><span class="line">    <span class="keyword">int</span> status;</span><br><span class="line">    <span class="keyword">for</span>(; n &lt; <span class="number">6</span>; n++)</span><br><span class="line">    &#123;</span><br><span class="line">        a.name = n;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入第"</span> &lt;&lt; n &lt;&lt; <span class="string">"个进程的运行时间："</span> ;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; time;</span><br><span class="line">        a.time = time;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入第"</span> &lt;&lt; n &lt;&lt; <span class="string">"个进程的优先级："</span> ;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; prior;</span><br><span class="line">        a.prior = prior;</span><br><span class="line">        a.status = <span class="number">1</span>;</span><br><span class="line">        T.insert(a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"------------------------------"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">while</span>(T.head-&gt;next)</span><br><span class="line">        &#123;<span class="built_in">run</span>(T);</span><br><span class="line">        T.show();&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2020/06/13/%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E6%A8%A1%E6%8B%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/%E6%89%A7%E8%A1%8C%E6%88%90%E6%9E%9C1.png" alt="执行成果1"><br><img src="/2020/06/13/%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%E6%A8%A1%E6%8B%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/%E6%89%A7%E8%A1%8C%E6%88%90%E6%9E%9C2.png" alt="执行成果2"></p>
<p>完</p>
]]></content>
      <categories>
        <category>homework</category>
      </categories>
  </entry>
</search>
